<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Simulation of Random Variables and Monte Carlo | Lecture notes for “Introduction to Stochastic Processes”</title>
  <meta name="description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Simulation of Random Variables and Monte Carlo | Lecture notes for “Introduction to Stochastic Processes”" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes" />
  <meta name="github-repo" content="gordanz/M362M" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Simulation of Random Variables and Monte Carlo | Lecture notes for “Introduction to Stochastic Processes”" />
  
  <meta name="twitter:description" content="A set of lecture notes for M362M: Introduction to Stochastic Processes" />
  

<meta name="author" content="Gordan Zitkovic" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="random-walks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">M362M Lecture notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> An intro to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#setting-up-an-r-environment-on-your-computer"><i class="fa fa-check"></i><b>1.1</b> Setting up an R environment on your computer</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#installing-r"><i class="fa fa-check"></i><b>1.1.1</b> Installing R</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#installing-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#installing-basic-packages"><i class="fa fa-check"></i><b>1.1.3</b> Installing basic packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#learning-the-basics-of-r"><i class="fa fa-check"></i><b>1.2</b> Learning the basics of R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#the-console-scripts-and-r-notebooks"><i class="fa fa-check"></i><b>1.2.1</b> The console, Scripts and R Notebooks</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#asking-for-help"><i class="fa fa-check"></i><b>1.2.2</b> Asking for help</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#vectors"><i class="fa fa-check"></i><b>1.2.3</b> Vectors</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#matrices"><i class="fa fa-check"></i><b>1.2.4</b> Matrices</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#functions"><i class="fa fa-check"></i><b>1.2.5</b> Functions</a></li>
<li class="chapter" data-level="1.2.6" data-path="intro.html"><a href="intro.html#if-else-statements"><i class="fa fa-check"></i><b>1.2.6</b> If-else statements</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#additional-problems-for-chapter-1"><i class="fa fa-check"></i><b>1.3</b> Additional Problems for Chapter 1</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#endnotes"><i class="fa fa-check"></i><b>1.4</b> Endnotes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html"><i class="fa fa-check"></i><b>2</b> Simulation of Random Variables and Monte Carlo</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#simulation-of-some-common-probability-distributions"><i class="fa fa-check"></i><b>2.1</b> Simulation of some common probability distributions</a></li>
<li class="chapter" data-level="2.2" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#multivariate-distributions"><i class="fa fa-check"></i><b>2.2</b> Multivariate Distributions</a></li>
<li class="chapter" data-level="2.3" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#monte-carlo"><i class="fa fa-check"></i><b>2.3</b> Monte Carlo</a></li>
<li class="chapter" data-level="2.4" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#conditional-distributions"><i class="fa fa-check"></i><b>2.4</b> Conditional distributions</a></li>
<li class="chapter" data-level="2.5" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#additional-problems-for-chapter-2"><i class="fa fa-check"></i><b>2.5</b> Additional Problems for Chapter 2</a></li>
<li class="chapter" data-level="2.6" data-path="simulation-of-random-variables-and-monte-carlo.html"><a href="simulation-of-random-variables-and-monte-carlo.html#endnotes-1"><i class="fa fa-check"></i><b>2.6</b> Endnotes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="random-walks.html"><a href="random-walks.html"><i class="fa fa-check"></i><b>3</b> Random Walks</a>
<ul>
<li class="chapter" data-level="3.1" data-path="random-walks.html"><a href="random-walks.html#what-are-stochastic-processes"><i class="fa fa-check"></i><b>3.1</b> What are stochastic processes?</a></li>
<li class="chapter" data-level="3.2" data-path="random-walks.html"><a href="random-walks.html#the-simple-symmetric-random-walk"><i class="fa fa-check"></i><b>3.2</b> The Simple Symmetric Random Walk</a></li>
<li class="chapter" data-level="3.3" data-path="random-walks.html"><a href="random-walks.html#how-to-simulate-random-walks"><i class="fa fa-check"></i><b>3.3</b> How to simulate random walks</a></li>
<li class="chapter" data-level="3.4" data-path="random-walks.html"><a href="random-walks.html#two-ways-of-looking-at-a-stochastic-proceses"><i class="fa fa-check"></i><b>3.4</b> Two ways of looking at a stochastic proceses</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="random-walks.html"><a href="random-walks.html#column-wise-distributionally"><i class="fa fa-check"></i><b>3.4.1</b> Column-wise (distributionally)</a></li>
<li class="chapter" data-level="3.4.2" data-path="random-walks.html"><a href="random-walks.html#row-wise-trajectorially-or-path-wise"><i class="fa fa-check"></i><b>3.4.2</b> Row-wise (trajectorially or path-wise)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="random-walks.html"><a href="random-walks.html#the-path-space"><i class="fa fa-check"></i><b>3.5</b> The path space</a></li>
<li class="chapter" data-level="3.6" data-path="random-walks.html"><a href="random-walks.html#the-distribution-of-x_n"><i class="fa fa-check"></i><b>3.6</b> The distribution of <span class="math inline">\(X_n\)</span></a></li>
<li class="chapter" data-level="3.7" data-path="random-walks.html"><a href="random-walks.html#biased-random-walks"><i class="fa fa-check"></i><b>3.7</b> Biased random walks</a></li>
<li class="chapter" data-level="3.8" data-path="random-walks.html"><a href="random-walks.html#additional-problems-for-chapter-3"><i class="fa fa-check"></i><b>3.8</b> Additional problems for Chapter 3</a></li>
<li class="chapter" data-level="3.9" data-path="random-walks.html"><a href="random-walks.html#endnotes-2"><i class="fa fa-check"></i><b>3.9</b> Endnotes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="more-about-random-walks.html"><a href="more-about-random-walks.html"><i class="fa fa-check"></i><b>4</b> More about Random Walks</a>
<ul>
<li class="chapter" data-level="4.1" data-path="more-about-random-walks.html"><a href="more-about-random-walks.html#the-reflection-principle"><i class="fa fa-check"></i><b>4.1</b> The reflection principle</a></li>
<li class="chapter" data-level="4.2" data-path="more-about-random-walks.html"><a href="more-about-random-walks.html#stopping-times"><i class="fa fa-check"></i><b>4.2</b> Stopping times</a></li>
<li class="chapter" data-level="4.3" data-path="more-about-random-walks.html"><a href="more-about-random-walks.html#walds-identity-and-gamblers-ruin"><i class="fa fa-check"></i><b>4.3</b> Wald’s identity and Gambler’s ruin</a></li>
<li class="chapter" data-level="4.4" data-path="more-about-random-walks.html"><a href="more-about-random-walks.html#additional-problems-for-chapter-4"><i class="fa fa-check"></i><b>4.4</b> Additional problems for Chapter 4</a></li>
<li class="chapter" data-level="4.5" data-path="more-about-random-walks.html"><a href="more-about-random-walks.html#endnotes-3"><i class="fa fa-check"></i><b>4.5</b> Endnotes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>5</b> Markov Chains</a>
<ul>
<li class="chapter" data-level="5.1" data-path="markov-chains.html"><a href="markov-chains.html#the-markov-property"><i class="fa fa-check"></i><b>5.1</b> The Markov property</a></li>
<li class="chapter" data-level="5.2" data-path="markov-chains.html"><a href="markov-chains.html#first-examples"><i class="fa fa-check"></i><b>5.2</b> First Examples</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="markov-chains.html"><a href="markov-chains.html#random-walks-1"><i class="fa fa-check"></i><b>5.2.1</b> Random walks</a></li>
<li class="chapter" data-level="5.2.2" data-path="markov-chains.html"><a href="markov-chains.html#gambler"><i class="fa fa-check"></i><b>5.2.2</b> Gambler’s ruin</a></li>
<li class="chapter" data-level="5.2.3" data-path="markov-chains.html"><a href="markov-chains.html#regime-switching"><i class="fa fa-check"></i><b>5.2.3</b> Regime Switching</a></li>
<li class="chapter" data-level="5.2.4" data-path="markov-chains.html"><a href="markov-chains.html#deterministically-monotone-markov-chain"><i class="fa fa-check"></i><b>5.2.4</b> Deterministically monotone Markov chain</a></li>
<li class="chapter" data-level="5.2.5" data-path="markov-chains.html"><a href="markov-chains.html#not-a-markov-chain"><i class="fa fa-check"></i><b>5.2.5</b> Not a Markov chain</a></li>
<li class="chapter" data-level="5.2.6" data-path="markov-chains.html"><a href="markov-chains.html#turning-a-non-markov-chain-into-a-markov-chain"><i class="fa fa-check"></i><b>5.2.6</b> Turning a non-Markov chain into a Markov chain</a></li>
<li class="chapter" data-level="5.2.7" data-path="markov-chains.html"><a href="markov-chains.html#deterministic-functions-of-markov-chains-do-not-need-to-be-markov-chains"><i class="fa fa-check"></i><b>5.2.7</b> Deterministic functions of Markov chains do not need to be Markov chains</a></li>
<li class="chapter" data-level="5.2.8" data-path="markov-chains.html"><a href="markov-chains.html#a-game-of-tennis"><i class="fa fa-check"></i><b>5.2.8</b> A game of tennis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="markov-chains.html"><a href="markov-chains.html#chapman-kolmogorov-equations"><i class="fa fa-check"></i><b>5.3</b> Chapman-Kolmogorov equations</a></li>
<li class="chapter" data-level="5.4" data-path="markov-chains.html"><a href="markov-chains.html#mc-sim"><i class="fa fa-check"></i><b>5.4</b> How to simulate Markov chains</a></li>
<li class="chapter" data-level="5.5" data-path="markov-chains.html"><a href="markov-chains.html#additional-problems-for-chapter-5"><i class="fa fa-check"></i><b>5.5</b> Additional problems for Chapter 5</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lecture notes for “Introduction to Stochastic Processes”</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-of-random-variables-and-monte-carlo" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Simulation of Random Variables and Monte Carlo<a href="simulation-of-random-variables-and-monte-carlo.html#simulation-of-random-variables-and-monte-carlo" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the spirit of “learn by doing”, these lecture notes contain many “Problems”,
both within the sections, and at the very end of each chapter. Those within
sections come with solutions and usually introduce new concepts. They often
feature a <em>Comments</em> section right after the solution subdivided into <em>R</em> and
<em>Math</em> comments focusing on the computational or conceptual features,
respectively. Note that you are not expected to be able to do the problems
within sections before reading their solutions and comments, so don’t worry if
you cannot. It is a good practice to try, though. Problems at the end, in the
Additional Problems section are (initially) left unsolved. They do not require
any new ideas and are there to help you practice the skills presented before.</p>
<div id="simulation-of-some-common-probability-distributions" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Simulation of some common probability distributions<a href="simulation-of-random-variables-and-monte-carlo.html#simulation-of-some-common-probability-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>… where we also review some probability along the way.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-5" class="exercise"><strong>Problem 2.1  </strong></span>“Draw” 50 simulations from the geometric distribution with parameter <span class="math inline">\(p=0.4\)</span>.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-6" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rgeom</span>(<span class="dv">50</span>,<span class="at">prob=</span><span class="fl">0.4</span>)</span>
<span id="cb37-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 1 0 3 4 1 2 0 0 2 2 0 1 5 0 1 0 2 1 1 0 2 2 2 1 0 0 1 3 2 2 1 1 1 3 5 0 1 1</span></span>
<span id="cb37-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [39] 0 0 0 1 2 0 1 1 1 0 1 0</span></span></code></pre></div>
<p><em>Comments (R):</em> R makes it very easy to simulate draws from a large class of <em>named
distributions</em><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>,
such as geometric, binomial, uniform, normal, etc. For a list of all available
distributions, run <code>help("distributions")</code> Each available distribution has an <em>R
name</em>; the uniform is <code>unif</code> the normal is <code>norm</code> and the binomial is <code>binom</code>,
etc. If you want to simulate <span class="math inline">\(n\)</span> draws (aka a <em>sample</em> of size <span class="math inline">\(n\)</span>) from a
distribution, you form a full command by appending the letter <code>r</code> to its R name
and use <span class="math inline">\(n\)</span> as an argument. That is how we arrived to <code>rgeom(50)</code> in the
solution above. The additional arguments of the function <code>rgeom</code> have to do with
the parameters of that distribution. Which parameters go with which
distributions, and how to input them as arguments to <code>rgeom</code> or <code>rnorm</code> is best
looked up in R’s extensive documentation. Try <code>help("rnorm")</code>, for example.</p>
<p><em>Comments (Math):</em>
You could spend your whole life trying to understand what it really means to
“simulate” or “generate” a random number. The numbers you obtain from so-called
<em>random number generators</em> (RNG) are never random. In fact, they are completely
deterministically generated. Still, sequences of numbers obtained from (good)
random number generators share so many properties with sequences of mythical
<em>truly</em> random numbers, that we can use them as if they were truly random. For
the purposes of this class, you can assume that the numbers R gives you as
<em>random</em> are random enough. Random number generation is a fascinating topic at
the intersection of number theory, probability, statistics, computer science and
even philosophy, but we do not have the time to cover any of it in this class.
If you want to read a story about a particularly bad random number generator, go
<a href="https://en.wikipedia.org/wiki/RANDU">here</a>.</p>
</div>
<p>You might have encountered a geometric distribution before. A random variable with that
distribution can take any positive integer value or <span class="math inline">\(0\)</span>, i.e., its support is
<span class="math inline">\({\mathbb N}_0=\{0,1,2,3,\dots\}\)</span>.
As you can see from the output above, the value <span class="math inline">\(0\)</span> appears more often than the value <span class="math inline">\(3\)</span>,
and the value <span class="math inline">\(23\)</span> does not appear at all in this particular simulation run. The
probability of seeing the value <span class="math inline">\(k\in \{0,1,2,3,\dots\}\)</span> as a result of a single
draw is given by <span class="math inline">\((1-p)^k p\)</span>, where <span class="math inline">\(p\)</span> is called the <em>parameter</em> of the distribution.</p>
<p>That corresponds to the following interpretation of the geometric distribution:
keep tossing a biased coin (with probability p of obtaining H) until you see the first H; the number Ts before that is that value your geometric random variable<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>
If we put these probabilities in a single table (and choose <span class="math inline">\(p=0.4\)</span>, for example) it is
going to look like this:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="left">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Prob.</td>
<td align="right">0.4</td>
<td align="right">0.24</td>
<td align="right">0.144</td>
<td align="right">0.086</td>
<td align="right">0.052</td>
<td align="right">0.031</td>
<td align="right">0.019</td>
<td align="right">0.011</td>
<td align="left">…</td>
</tr>
</tbody>
</table>
<p>Of course, the possible values our random variable can take do not stop at <span class="math inline">\(7\)</span>.
In fact, there are infinitely many possible values, but we do not have infinite
space. Note that even though the value <span class="math inline">\(23\)</span> does not appear in the output of the
command <code>rgeom</code> above, it probably would if we simulated many more than <span class="math inline">\(50\)</span>
values. Let’s try it with <span class="math inline">\(500\)</span> draws - the table below counts how many <span class="math inline">\(0s\)</span>,
<span class="math inline">\(1s\)</span>, <span class="math inline">\(2s\)</span>, etc. we got:</p>
<table>
<thead>
<tr class="header">
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">208</td>
<td align="right">132</td>
<td align="right">62</td>
<td align="right">43</td>
<td align="right">23</td>
<td align="right">16</td>
<td align="right">8</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Still no luck, but we do observe values above 5 more often. By trial and error,
we arrive at about <span class="math inline">\(1,000,000\)</span> as the required number of simulations:</p>
<table>
<thead>
<tr class="header">
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="left">…</th>
<th align="right">23</th>
<th align="right">24</th>
<th align="right">25</th>
<th align="right">26</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">400616</td>
<td align="right">238946</td>
<td align="right">144274</td>
<td align="right">86489</td>
<td align="left">…</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<div class="exercise">
<p><span id="exr:unlabeled-div-7" class="exercise"><strong>Problem 2.2  </strong></span>Compute the probability that among <span class="math inline">\(1,000,000\)</span> draws of a geometric random
variable with parameter <span class="math inline">\(p=0.4\)</span>, we never see a number greater than <span class="math inline">\(22\)</span>.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-8" class="solution"><em>Solution</em>. </span>First, we compute the probability that the value seen in a <em>single</em> draw does not exceed <span class="math inline">\(22\)</span>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgeom</span>(<span class="dv">22</span>,<span class="at">prob=</span><span class="fl">0.4</span>)</span>
<span id="cb38-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9999921</span></span></code></pre></div>
<p>Different draws are <em>independent</em> of each other, so we need to raise this to the power <span class="math inline">\(1,000,000\)</span>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb39-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">pgeom</span>(<span class="dv">22</span>, <span class="at">prob =</span> <span class="fl">0.4</span>))<span class="sc">^</span>(<span class="dv">1000000</span>)</span>
<span id="cb39-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.0003717335</span></span></code></pre></div>
<p><em>Comments (R):</em> The command we used here is <code>pgeom</code> which is a cousin of <code>rgeom</code>. In
general, R commands that involve named probability distributions consist of two
parts. The prefix, i.e., the initial letter (<code>p</code> in this case) stands for the
operation you want to perform, and the rest is the R name of the distribution.
There are 4 prefixes, and the commands they produce are</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Prefix</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>r</code></td>
<td align="left">Simulate <strong>r</strong>andom draws from the distribution.</td>
</tr>
<tr class="even">
<td align="left"><code>p</code></td>
<td align="left">Compute the cumulative <strong>p</strong>robability distribution function (cdf) (<strong>NOT pdf</strong>)</td>
</tr>
<tr class="odd">
<td align="left"><code>d</code></td>
<td align="left">Compute the probability <strong>d</strong>ensity (pdf) or the probability mass function (pmf)</td>
</tr>
<tr class="even">
<td align="left"><code>q</code></td>
<td align="left">Compute the <strong>q</strong>uantile function</td>
</tr>
</tbody>
</table>
<p>(see the Math section below for the reminder of what these things are). In this
problem, we are dealing with a geometric random variable <span class="math inline">\(X\)</span>, which has a
discrete distribution with support <span class="math inline">\(0,1,2,3,\dots\)</span>. Therefore, the R name is
<code>geom</code>. We are interested in the probability <span class="math inline">\({\mathbb{P}}[ X\leq 22]\)</span>, which
corresponds to the cdf of <span class="math inline">\(X\)</span> at <span class="math inline">\(x=22\)</span>, so we use the
the prefix <code>p</code>. Finally, we used the named parameter <code>p</code> and gave it the value <code>p = 0.4</code>, because the geometric distribution has a single parameter <span class="math inline">\(p\)</span>.</p>
<p>This problem also gives us a chance to discuss precision. As you can see, the
probability of a single draw not exceeding <span class="math inline">\(22\)</span> is very close to <span class="math inline">\(1\)</span>. In fact,
it is equal to it to 5 decimal places. By default, R displays 7 significant
digits of a number. That is enough for most applications (and barely enough for
this one), but sometimes we need more. For example, let’s try to compute the
probability of seeing no T (tails) in 10 tosses of a biased coin, where the
probability of H (heads) is 0.9.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="fl">-0.1</span><span class="sc">^</span><span class="dv">10</span></span>
<span id="cb40-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span></code></pre></div>
<p>While very close to it, this probability is clearly not equal to <span class="math inline">\(1\)</span>, as suggested by the output above.
The culprit is the default precision. We can increase the precision (up to <span class="math inline">\(22\)</span> digits) using the <code>options</code> command</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">17</span>)</span>
<span id="cb41-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="fl">-0.1</span><span class="sc">^</span><span class="dv">10</span></span>
<span id="cb41-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.99999999989999999</span></span></code></pre></div>
<p>Precision issues like this one should not appear in this course, but they will
out there “in the wild”, so it might be a good idea to be aware of them.</p>
<p><em>Comments (Math):</em> If you forgot all about pdfs, cdfs and such things here is a little reminder:</p>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<tbody>
<tr class="odd">
<td>cdf</td>
<td><span class="math inline">\(F(x) = {\mathbb{P}}[X\leq x]\)</span></td>
</tr>
<tr class="even">
<td>pdf</td>
<td><span class="math inline">\(f(x)\)</span> such that <span class="math inline">\({\mathbb{P}}[X \in [a,b]] = \int_a^b f(x) \, dx\)</span> for all <span class="math inline">\(a&lt;b\)</span></td>
</tr>
<tr class="odd">
<td>pmf</td>
<td><span class="math inline">\(p(x)\)</span> such that <span class="math inline">\({\mathbb{P}}[X=a_n] = p(a_n)\)</span> for some sequence <span class="math inline">\(a_n\)</span></td>
</tr>
<tr class="even">
<td>qf</td>
<td><span class="math inline">\(q(p)\)</span> is a number such that <span class="math inline">\({\mathbb{P}}[ X \leq q(p)] = p\)</span></td>
</tr>
</tbody>
</table>
<p>Those random variables that admit a pdf are called <strong>continuous</strong>. The prime
examples are the normal, or the exponential distribution. The ones where a pmf
exists are called <strong>discrete</strong>. The sequence <span class="math inline">\(a_n\)</span> covers all values that such
a, discrete, random variable can take. Most often, <span class="math inline">\(a_n\)</span> either covers the set
of all natural numbers <span class="math inline">\(0,1,2,\dots\)</span> or a finite subset such as <span class="math inline">\(1,2,3,4,5,6\)</span>.</p>
<p>Coming back to our original problem, we note that the probability we obtained is
quite small. Since <span class="math inline">\(1/0.000372\)</span> is about <span class="math inline">\(2690\)</span>, we would have to run about
<span class="math inline">\(2690\)</span> rounds of <span class="math inline">\(1,000,000\)</span> simulations before the largest number falls below
<span class="math inline">\(23\)</span>.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-9" class="exercise"><strong>Problem 2.3  </strong></span>Compute the <span class="math inline">\(0.05\)</span>, <span class="math inline">\(0.1\)</span>, <span class="math inline">\(0.4\)</span>, <span class="math inline">\(0.6\)</span> and <span class="math inline">\(0.95\)</span> quantiles of the normal
distribution with mean <span class="math inline">\(1\)</span> and standard deviation <span class="math inline">\(2\)</span>.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-10" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>( <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.95</span>), <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb42-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -2.2897073 -1.5631031  0.4933058  1.5066942  4.2897073</span></span></code></pre></div>
<p><em>Comments (R):</em> The function we used is <code>qnorm</code>, with the prefix <code>q</code> which computes the
quantile function and the R name <code>norm</code> because we are looking for the quantiles
of the normal distribution. The additional (named) parameters are where the
parameters of the distribution come in (the mean and the standard variation) in
this case. Note how we plugged in the entire vector
<code>c(0.05, 0.1, 0.4, 0.6, 0.98)</code> instead of a single value into <code>qnorm</code>. You can
do that because this function is <strong>vectorized</strong>. That means that if you give it
a vector as an argument, it will “apply itself” to each component of the vector
separately, and return the vector of results. Many (but not all) functions in R
are vectorized<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</p>
<p>As a sanity check, let’s apply <code>pnrom</code> (which computes the cdf of the normal) to these quantile values:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb43-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span>  <span class="fu">qnorm</span>( <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.95</span>), <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb43-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>( p , <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb43-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.05 0.10 0.40 0.60 0.95</span></span></code></pre></div>
<p>As expected, we got the original values back - the normal quantile function and its cdf are inverses of each other.</p>
<p><em>Comments (Math):</em> Computing the cdf of a standard normal is the same thing reading a
<em>normal table</em>. Computing a quantile is the opposite; you go into the middle of
the table and find your value, and then figure out which “Z” would give you that
value.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-11" class="exercise"><strong>Problem 2.4  </strong></span>Simulate <span class="math inline">\(60\)</span> throws of a fair <span class="math inline">\(10\)</span>-sided die.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-12" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>( <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> , <span class="dv">60</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1]  2  8  9  8  4  7  7  7  2  3  3 10  6  1  9  7  4  7  6  2  2  3 10  1  9</span></span>
<span id="cb44-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [26]  7  3  2  8  4  1  2  8  1  4  9  1  9 10 10  6  1  8  6  1 10  5  1  6  9</span></span>
<span id="cb44-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [51]  8  3  8  9  4  6  1  6  7  8</span></span></code></pre></div>
<p><em>Comments (Math):</em> Let <span class="math inline">\(X\)</span> denote the outcome of a single throw of a fair <span class="math inline">\(10\)</span>-sided die.
The distribution of <span class="math inline">\(X\)</span> is discrete (it can only take the values
<span class="math inline">\(1,2,\dots, 10\)</span>) but it is not one of the more famous named distributions. I
guess you could call it a <em>discrete uniform on <span class="math inline">\({1,2,\dots, 10}\)</span></em>, but a better
way to describe such distribution is by a <strong>distribution table</strong>, which is
really just a list of possible values a random variable can take, together with
their, respective, probabilities. In this case,</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
1
</th>
<th style="text-align:left;">
2
</th>
<th style="text-align:left;">
3
</th>
<th style="text-align:left;">
4
</th>
<th style="text-align:left;">
5
</th>
<th style="text-align:left;">
6
</th>
<th style="text-align:left;">
7
</th>
<th style="text-align:left;">
8
</th>
<th style="text-align:left;">
9
</th>
<th style="text-align:left;">
10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.1
</td>
</tr>
</tbody>
</table>
<p><em>Comments (R):</em> The command used to draw a sample from a (finite) collection is, of, course
<code>sample</code>. The first argument is a vector, and it plays the role of the “bag”
from which you are drawing. If we are interested in repeated, random samples, we
also need to specify <code>replace = FALSE</code> otherwise, you could draw any single
number at most once:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">8</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  1  5  6  7  8 10  3  4</span></span></code></pre></div>
<p>With more than 10 draws, we would run out of numbers to draw:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">12</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Error in sample.int(length(x), size, replace, prob): cannot take a sample larger than the population when &#39;replace = FALSE&#39;</span></span></code></pre></div>
<p>The bag you draw from can contain objects other than numbers:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>( <span class="fu">c</span>(<span class="st">&quot;Picard&quot;</span>, <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Geordi&quot;</span>), <span class="dv">9</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Picard&quot; &quot;Data&quot;   &quot;Geordi&quot; &quot;Geordi&quot; &quot;Data&quot;   &quot;Data&quot;   &quot;Picard&quot; &quot;Data&quot;  </span></span>
<span id="cb47-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [9] &quot;Geordi&quot;</span></span></code></pre></div>
So far, each object in the bag had the same probability of being drawn. You can
use the <code>sample</code> command to produce a <em>weighted</em> sample, too. For example, if we
wanted to simulate <span class="math inline">\(10\)</span> draws from the following distribution
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
</tbody>
</table>
<p>we would use the additional argument <code>prob</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>( <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.7</span>, <span class="fl">0.1</span>))</span>
<span id="cb48-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 1 2 2 1 1 2 2 3 2 2</span></span></code></pre></div>
<p>Note how it is mostly <span class="math inline">\(2\)</span>s, as expected.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-13" class="exercise"><strong>Problem 2.5  </strong></span>Draw a sample of size <span class="math inline">\(n=10\)</span> from <span class="math inline">\(N(1,2)\)</span>, i.e., from the normal distribution
with parameters <span class="math inline">\(\mu=1\)</span>, <span class="math inline">\(\sigma = 2\)</span>. Plot a histogram of the obtained
values. Repeat for <span class="math inline">\(n=100\)</span> and <span class="math inline">\(n=100000\)</span>.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-14" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb49-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb49-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb50-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb50-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb51-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb51-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-67-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Comments (R):</em> It cannot be simpler! You use the command <code>hist</code>, feed it a vector of
values, and it produces a histogram. It will even label the axes for you. If you
want to learn how to tweak various features of your histogram, type <code>?hist</code>.</p>
<p>Esthetically, the built-in histograms leave something to be desired. We can do better, using the package <code>ggplot2</code>. You don’t have to use it in this class, but if you want to, you install it first by running <code>install.packages("ggplot2")</code> (you have to do this only once). Then, every time you want to use it, you run <code>library(ggplot2)</code> to notify R that you are about to use a function from that package. It would take a whole semester to learn everything there is to know about <code>ggplot2</code>; I will only show what a histogram looks like in it:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb52-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb52-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">as.data.frame</span>(z), <span class="fu">aes</span>(<span class="at">x=</span>z))<span class="sc">+</span></span>
<span id="cb52-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb52-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">color=</span><span class="st">&quot;DarkRed&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-68-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Comments (Math):</em>. Mathematically, histogram can be produced for any (finite) sequence of
numbers: we divide the range into several bins, count how many of the points in
the sequence falls into each bin, and then draw a bar above that bin whose
height is equal (or proportional to) that count. The picture tells use about how
the sequence we started from is “distributed”. The order of the points does not
matter - you would get exactly the same picture if you sorted the points first.
If the sequence of points you draw the histogram of comes from, say, normal
distribution, the histogram will resemble the shape of the pdf of a normal
distribution. I say resemble, because its shape is ultimately random. If the
number of points is small (like in the second part of this problem) the
histogram may look nothing like the normal pdf. However, when the number of
points gets larger and larger, the shape of the histogram gets closer and closer
to the underlying pdf (if it exists). I keep writing “shape” because the three
histograms above have very different scales on the <span class="math inline">\(y\)</span> axis. That is because we
used counts to set the vertical sizes of bins.
A more natural choice is to use the proportions, i.e. relative frequencies (i.e.
counts divided by the total number of points) for bar heights. More precisely,
the bar height <span class="math inline">\(h\)</span> over the bin <span class="math inline">\([a,b]\)</span> is chosen so that the area of the bar,
i.e., <span class="math inline">\((b-a)\times h\)</span> equals to the proportion of all points that fall inside
<span class="math inline">\([a,b]\)</span>. This way, the total area under the histogram is always <span class="math inline">\(1\)</span>. To draw
such a <strong>density histogram</strong> in R we would
need to add the additional option <code>freq = FALSE</code> to <code>hist</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb53-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb53-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-69-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note how the <span class="math inline">\(y\)</span>-axes label changed from “Frequency” to “Density”.
With such a normalization, the histogram of <span class="math inline">\(x\)</span> can be directly compared to the
probability density of a normal distribution. Here is a histogram of <span class="math inline">\(100,000\)</span>
simulations from our normal distribution with its density function (pdf)
superimposed:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb54-1" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb54-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb54-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="fl">0.02</span>)</span>
<span id="cb54-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb54-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb54-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sims, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb54-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,y, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span> )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multivariate-distributions" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Multivariate Distributions<a href="simulation-of-random-variables-and-monte-carlo.html#multivariate-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-15" class="exercise"><strong>Problem 2.6  </strong></span>Let <code>x</code> contain <span class="math inline">\(2,000\)</span> draws from <span class="math inline">\(N(0,1)\)</span>, <code>z</code> another <span class="math inline">\(2,000\)</span> draws from <span class="math inline">\(N(0,1)\)</span> and let <code>y=x^2+z</code>.</p>
<ol style="list-style-type: decimal">
<li><p>Draw a scatterplot of <code>x</code> and <code>y</code> to visualize the joint distribution of <code>x</code> and <code>y</code></p></li>
<li><p>Plot two histograms, one of <code>x</code> and one of <code>y</code>. Do they tell the whole story
about the joint distribution of <code>x</code> and <code>y</code>?</p></li>
<li><p>Are <code>x</code> and <code>y</code> correlated? Do <code>x</code> and <code>y</code> in your plot “look independent”?
Use the permutation test to check of independence between <code>x</code> and <code>y</code>.</p></li>
</ol>
</div>
<div class="solution">
<p><span id="unlabeled-div-16" class="solution"><em>Solution</em>. </span> </p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb55-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>)</span>
<span id="cb55-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb55-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>)</span>
<span id="cb55-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb55-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>z</span>
<span id="cb55-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="672" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span>
<span id="cb56-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-72-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>No, the two histograms would not be enough to describe the joint distribution.
There are many ways in which two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> can be jointly
distributed, but whose separate (marginal) distributions match the histograms
above. To give a very simple example, let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be discrete random
variables, each of which can only take values <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>. Consider the following
two possible <em>joint</em> distribution tables for the random pair <span class="math inline">\((X,Y)\)</span>:</p>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;text-align: center;">
</th>
<th style="text-align:right;text-align: center;">
0
</th>
<th style="text-align:right;text-align: center;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
0
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;text-align: center;">
</th>
<th style="text-align:right;text-align: center;">
0
</th>
<th style="text-align:right;text-align: center;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>In both cases, the marginals are the same, i.e., both <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are equally
likely to take the value <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>, i.e., they both have the Bernoulli
distribution with parameter <span class="math inline">\(p=1/2\)</span>. That would correspond to the separate
histograms to be the same. On the other hand, their joint distributions (aka
dependence structures) are completely different. In the first (left) case, <span class="math inline">\(X\)</span>
and <span class="math inline">\(Y\)</span> are independent, but in the second they are completely dependent.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>They are probably not correlated since the sample correlation between <code>x</code>
and <code>y</code> is close to <span class="math inline">\(0\)</span>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb57-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cor</span>(x,y))</span>
<span id="cb57-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.02880239</span></span></code></pre></div>
<p>but they do not look independent.</p>
<p>To apply the permutation test, we first plot the scatterplot of <code>x</code> vs. <code>y</code> as
above. Then, we replace <code>y</code> by a vector with the same components, but randomly
permute their positions, and then plot a scatterplot again. We repeat this three
times:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb58-1" aria-hidden="true" tabindex="-1"></a>y_perm_1 <span class="ot">=</span> <span class="fu">sample</span>(y)</span>
<span id="cb58-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb58-2" aria-hidden="true" tabindex="-1"></a>y_perm_2 <span class="ot">=</span> <span class="fu">sample</span>(y)</span>
<span id="cb58-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb58-3" aria-hidden="true" tabindex="-1"></a>y_perm_3 <span class="ot">=</span> <span class="fu">sample</span>(y)</span>
<span id="cb58-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb58-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y_perm_1)</span>
<span id="cb58-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y_perm_2)</span>
<span id="cb58-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y_perm_3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The conclusion is clear, the first (upper-left) plot is very different than the
other three. Therefore, <code>x</code> and <code>y</code> are probably not independent.</p>
<p><em>Comments (Math):</em> The point of this problem is to review the notion of the <strong>joint
distribution</strong> between two random variables. The most important point here is
that there is more to the joint distribution of two random vectors, than just
the two distributions taken separately. In a sense, the whole is (much) more
than the sum of its parts. This is something that does not happen in the
deterministic world. If you give me the <span class="math inline">\(x\)</span>-coordinate of a point, and,
separately, its <span class="math inline">\(y\)</span>-coordinate, I will be able to pinpoint the exact location of
that point.</p>
<p>On the other hand, suppose that the <span class="math inline">\(x\)</span>-coordinate of a point is unknown, so we
treat it as a random variable, and suppose that this variable admits the
standard normal distribution. Do the same for <span class="math inline">\(y\)</span>. Even with this information,
you cannot say anything about the position of the point <span class="math inline">\((x,y)\)</span>. It could be
that the reason we are uncertain about <span class="math inline">\(x\)</span> and the reason we are uncertain about
<span class="math inline">\(y\)</span> have nothing to do with each other; in that case we would be right to assume
that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are independent. If, on the other hand, we got the values of
both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> by measuring them using the same, inaccurate, tape measure, we
cannot assume that the errors are independent. It is more likely that both <span class="math inline">\(x\)</span>
and <span class="math inline">\(y\)</span> are too big, or both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are too small.</p>
<p>Mathematically, we say that random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent if
<span class="math display">\[{\mathbb{P}}[X \in [a,b]] \times {\mathbb{P}}[ Y \in [c,d] ] = {\mathbb{P}}[ X\in [a,b] \text{ and } Y\in [c,d]]\text{ for all } a,b,c,d.\]</span>
While up to the point,
this definition is not very eye-opening, or directly applicable in most cases.
Intuitively, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent if the distribution of <span class="math inline">\(Y\)</span> would not
change if we received additional information about <span class="math inline">\(X\)</span>. In our problem, random
variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> correspond to vectors <code>x</code> and <code>y</code>. Their scatterplot above
clearly conveys the following message: when <code>x</code> is around <span class="math inline">\(-2\)</span>, we expect <code>y</code> to
be around <code>4</code>, while when <code>x</code> is around <span class="math inline">\(0\)</span>, <code>y</code> would be expected to be around
<span class="math inline">\(0\)</span>, too.</p>
<p>Sometimes, it is not so easy to decide whether two variables are independent by staring at a scatterplot. What would you say about the scatterplot below?
<img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="50%" style="display: block; margin: auto;" />
The <strong>permutation test</strong> is designed to help you decide when two (simulated)
random variables are likely to be independent. The idea is simple. Suppose that
<code>x</code> and <code>y</code> are simulations from two independent (not necessarily identical)
distributions; say <code>x=runif(1000)</code> and <code>y=rnorm(1000)</code>. The vector
<code>y_perm=sample(y)</code> is a randomly permuted version of <code>y</code> (see R section below)
and it contains exactly the same information about the distribution of <code>y</code> as
<code>y</code> itself does. Both <code>y</code> and <code>y_perm</code> will produce exactly the same histogram.
Permuting <code>y</code>, however, “uncouples” it from <code>x</code>. If there was any dependence
between the values of <code>x</code> and <code>y</code> before, there certainly isn’t any now. In
other the joint distribution of <code>x</code> and <code>y_perm</code> has the same marginals as the
joint distribution of <code>x</code> and <code>y</code>, but all the (possible) dependence has been
removed. What remains is to compare the scatterplot between <code>x</code> and <code>y</code> and the
scatterplot between <code>x</code> and <code>y_perm</code>. If they look about the same, we conclude
that <code>x</code> and <code>y</code> are independent. Otherwise, there is some dependence between
them.</p>
<p>One question remains: why did we have to draw three scatterplots of permuted
versions of <code>y</code>? That is because we have only finitely many data points, and it
can happen, by pure chance, that the permutation we applied to <code>y</code> does not
completely scramble its dependence on <code>x</code>. With a “sample” of three such plots,
we
get a better feeling for the inherent randomness in this permutation procedure,
and it is much easier to tell whether “one of these things is not like the
others”. Btw, the random variables in the scatterplot above are, indeed,
independent; here are the <span class="math inline">\(4\)</span> permutation-test plots to “prove” it:
<img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Unlike univariate (one-variable) distributions which are visualized using
histograms or similar plots, multivariate (several-variable) distributions are
harder to depict. The most direct relative of the histogram is a <strong>3d
histogram</strong>. Just like the <span class="math inline">\(x\)</span>-axis is divided into bins in the univariate case,
in the multivariate case we divide the <span class="math inline">\(xy\)</span>-plane into regions (squares, e.g.)
and count the number of points falling into each of these regions. After that
a 3d bar (a skyscraper) is drawn above each square with the height of each
skyscraper equal (or proportional) to the number of points which fall into its
base. Here is a 3d histogram of our original pair (<code>x</code>,<code>y</code>) from the problem.
You should be able to rotate and zoom it right here in the notes, provided your
browser has JavaScript enabled:</p>
<div align="center">
<pre><code>## Warning: `includeHTML()` was provided a `path` that appears to be a complete HTML document.
## ✖ Path: pics/3dhist.html
## ℹ Use `tags$iframe()` to include an HTML document. You can either ensure `path` is accessible in your app or document (see e.g. `shiny::addResourcePath()`) and pass the relative path to the `src` argument. Or you can read the contents of `path` and pass the contents to `srcdoc`.</code></pre>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>
        
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="98c4b07f-5cfa-4b01-bebc-368a7a67fb26" class="plotly-graph-div" style="height:700px; width:650px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("98c4b07f-5cfa-4b01-bebc-368a7a67fb26")) {
                    Plotly.newPlot(
                        '98c4b07f-5cfa-4b01-bebc-368a7a67fb26',
                        [{"color": "#cc5500", "flatshading": true, "i": [256, 274, 256, 273, 256, 259, 273, 274, 258, 275, 259, 273, 288, 306, 288, 305, 288, 291, 305, 306, 290, 307, 291, 305, 320, 334, 320, 333, 320, 323, 333, 334, 322, 335, 323, 333, 344, 354, 344, 353, 344, 347, 353, 354, 346, 355, 347, 353, 168, 198, 168, 197, 168, 171, 197, 198, 170, 199, 171, 197, 224, 242, 224, 241, 224, 227, 241, 242, 226, 243, 227, 241, 260, 278, 260, 277, 260, 263, 277, 278, 262, 279, 263, 277, 292, 310, 292, 309, 292, 295, 309, 310, 294, 311, 295, 309, 32, 54, 32, 53, 32, 35, 53, 54, 34, 55, 35, 53, 72, 98, 72, 97, 72, 75, 97, 98, 74, 99, 75, 97, 120, 146, 120, 145, 120, 123, 145, 146, 122, 147, 123, 145, 172, 202, 172, 201, 172, 175, 201, 202, 174, 203, 175, 201, 228, 246, 228, 245, 228, 231, 245, 246, 230, 247, 231, 245, 0, 18, 0, 17, 0, 3, 17, 18, 2, 19, 3, 17, 36, 58, 36, 57, 36, 39, 57, 58, 38, 59, 39, 57, 76, 102, 76, 101, 76, 79, 101, 102, 78, 103, 79, 101, 124, 150, 124, 149, 124, 127, 149, 150, 126, 151, 127, 149, 176, 206, 176, 205, 176, 179, 205, 206, 178, 207, 179, 205, 4, 22, 4, 21, 4, 7, 21, 22, 6, 23, 7, 21, 40, 62, 40, 61, 40, 43, 61, 62, 42, 63, 43, 61, 80, 106, 80, 105, 80, 83, 105, 106, 82, 107, 83, 105, 128, 154, 128, 153, 128, 131, 153, 154, 130, 155, 131, 153, 8, 26, 8, 25, 8, 11, 25, 26, 10, 27, 11, 25, 44, 66, 44, 65, 44, 47, 65, 66, 46, 67, 47, 65, 84, 110, 84, 109, 84, 87, 109, 110, 86, 111, 87, 109, 132, 158, 132, 157, 132, 135, 157, 158, 134, 159, 135, 157, 180, 210, 180, 209, 180, 183, 209, 210, 182, 211, 183, 209, 12, 30, 12, 29, 12, 15, 29, 30, 14, 31, 15, 29, 48, 70, 48, 69, 48, 51, 69, 70, 50, 71, 51, 69, 88, 114, 88, 113, 88, 91, 113, 114, 90, 115, 91, 113, 136, 162, 136, 161, 136, 139, 161, 162, 138, 163, 139, 161, 184, 214, 184, 213, 184, 187, 213, 214, 186, 215, 187, 213, 92, 118, 92, 117, 92, 95, 117, 118, 94, 119, 95, 117, 140, 166, 140, 165, 140, 143, 165, 166, 142, 167, 143, 165, 188, 218, 188, 217, 188, 191, 217, 218, 190, 219, 191, 217, 232, 250, 232, 249, 232, 235, 249, 250, 234, 251, 235, 249, 264, 282, 264, 281, 264, 267, 281, 282, 266, 283, 267, 281, 192, 222, 192, 221, 192, 195, 221, 222, 194, 223, 195, 221, 236, 254, 236, 253, 236, 239, 253, 254, 238, 255, 239, 253, 268, 286, 268, 285, 268, 271, 285, 286, 270, 287, 271, 285, 296, 314, 296, 313, 296, 299, 313, 314, 298, 315, 299, 313, 324, 338, 324, 337, 324, 327, 337, 338, 326, 339, 327, 337, 300, 318, 300, 317, 300, 303, 317, 318, 302, 319, 303, 317, 328, 342, 328, 341, 328, 331, 341, 342, 330, 343, 331, 341, 348, 358, 348, 357, 348, 351, 357, 358, 350, 359, 351, 357], "j": [272, 258, 257, 272, 258, 257, 272, 275, 259, 274, 257, 275, 304, 290, 289, 304, 290, 289, 304, 307, 291, 306, 289, 307, 332, 322, 321, 332, 322, 321, 332, 335, 323, 334, 321, 335, 352, 346, 345, 352, 346, 345, 352, 355, 347, 354, 345, 355, 196, 170, 169, 196, 170, 169, 196, 199, 171, 198, 169, 199, 240, 226, 225, 240, 226, 225, 240, 243, 227, 242, 225, 243, 276, 262, 261, 276, 262, 261, 276, 279, 263, 278, 261, 279, 308, 294, 293, 308, 294, 293, 308, 311, 295, 310, 293, 311, 52, 34, 33, 52, 34, 33, 52, 55, 35, 54, 33, 55, 96, 74, 73, 96, 74, 73, 96, 99, 75, 98, 73, 99, 144, 122, 121, 144, 122, 121, 144, 147, 123, 146, 121, 147, 200, 174, 173, 200, 174, 173, 200, 203, 175, 202, 173, 203, 244, 230, 229, 244, 230, 229, 244, 247, 231, 246, 229, 247, 16, 2, 1, 16, 2, 1, 16, 19, 3, 18, 1, 19, 56, 38, 37, 56, 38, 37, 56, 59, 39, 58, 37, 59, 100, 78, 77, 100, 78, 77, 100, 103, 79, 102, 77, 103, 148, 126, 125, 148, 126, 125, 148, 151, 127, 150, 125, 151, 204, 178, 177, 204, 178, 177, 204, 207, 179, 206, 177, 207, 20, 6, 5, 20, 6, 5, 20, 23, 7, 22, 5, 23, 60, 42, 41, 60, 42, 41, 60, 63, 43, 62, 41, 63, 104, 82, 81, 104, 82, 81, 104, 107, 83, 106, 81, 107, 152, 130, 129, 152, 130, 129, 152, 155, 131, 154, 129, 155, 24, 10, 9, 24, 10, 9, 24, 27, 11, 26, 9, 27, 64, 46, 45, 64, 46, 45, 64, 67, 47, 66, 45, 67, 108, 86, 85, 108, 86, 85, 108, 111, 87, 110, 85, 111, 156, 134, 133, 156, 134, 133, 156, 159, 135, 158, 133, 159, 208, 182, 181, 208, 182, 181, 208, 211, 183, 210, 181, 211, 28, 14, 13, 28, 14, 13, 28, 31, 15, 30, 13, 31, 68, 50, 49, 68, 50, 49, 68, 71, 51, 70, 49, 71, 112, 90, 89, 112, 90, 89, 112, 115, 91, 114, 89, 115, 160, 138, 137, 160, 138, 137, 160, 163, 139, 162, 137, 163, 212, 186, 185, 212, 186, 185, 212, 215, 187, 214, 185, 215, 116, 94, 93, 116, 94, 93, 116, 119, 95, 118, 93, 119, 164, 142, 141, 164, 142, 141, 164, 167, 143, 166, 141, 167, 216, 190, 189, 216, 190, 189, 216, 219, 191, 218, 189, 219, 248, 234, 233, 248, 234, 233, 248, 251, 235, 250, 233, 251, 280, 266, 265, 280, 266, 265, 280, 283, 267, 282, 265, 283, 220, 194, 193, 220, 194, 193, 220, 223, 195, 222, 193, 223, 252, 238, 237, 252, 238, 237, 252, 255, 239, 254, 237, 255, 284, 270, 269, 284, 270, 269, 284, 287, 271, 286, 269, 287, 312, 298, 297, 312, 298, 297, 312, 315, 299, 314, 297, 315, 336, 326, 325, 336, 326, 325, 336, 339, 327, 338, 325, 339, 316, 302, 301, 316, 302, 301, 316, 319, 303, 318, 301, 319, 340, 330, 329, 340, 330, 329, 340, 343, 331, 342, 329, 343, 356, 350, 349, 356, 350, 349, 356, 359, 351, 358, 349, 359], "k": [274, 256, 273, 256, 259, 256, 274, 273, 275, 258, 273, 259, 306, 288, 305, 288, 291, 288, 306, 305, 307, 290, 305, 291, 334, 320, 333, 320, 323, 320, 334, 333, 335, 322, 333, 323, 354, 344, 353, 344, 347, 344, 354, 353, 355, 346, 353, 347, 198, 168, 197, 168, 171, 168, 198, 197, 199, 170, 197, 171, 242, 224, 241, 224, 227, 224, 242, 241, 243, 226, 241, 227, 278, 260, 277, 260, 263, 260, 278, 277, 279, 262, 277, 263, 310, 292, 309, 292, 295, 292, 310, 309, 311, 294, 309, 295, 54, 32, 53, 32, 35, 32, 54, 53, 55, 34, 53, 35, 98, 72, 97, 72, 75, 72, 98, 97, 99, 74, 97, 75, 146, 120, 145, 120, 123, 120, 146, 145, 147, 122, 145, 123, 202, 172, 201, 172, 175, 172, 202, 201, 203, 174, 201, 175, 246, 228, 245, 228, 231, 228, 246, 245, 247, 230, 245, 231, 18, 0, 17, 0, 3, 0, 18, 17, 19, 2, 17, 3, 58, 36, 57, 36, 39, 36, 58, 57, 59, 38, 57, 39, 102, 76, 101, 76, 79, 76, 102, 101, 103, 78, 101, 79, 150, 124, 149, 124, 127, 124, 150, 149, 151, 126, 149, 127, 206, 176, 205, 176, 179, 176, 206, 205, 207, 178, 205, 179, 22, 4, 21, 4, 7, 4, 22, 21, 23, 6, 21, 7, 62, 40, 61, 40, 43, 40, 62, 61, 63, 42, 61, 43, 106, 80, 105, 80, 83, 80, 106, 105, 107, 82, 105, 83, 154, 128, 153, 128, 131, 128, 154, 153, 155, 130, 153, 131, 26, 8, 25, 8, 11, 8, 26, 25, 27, 10, 25, 11, 66, 44, 65, 44, 47, 44, 66, 65, 67, 46, 65, 47, 110, 84, 109, 84, 87, 84, 110, 109, 111, 86, 109, 87, 158, 132, 157, 132, 135, 132, 158, 157, 159, 134, 157, 135, 210, 180, 209, 180, 183, 180, 210, 209, 211, 182, 209, 183, 30, 12, 29, 12, 15, 12, 30, 29, 31, 14, 29, 15, 70, 48, 69, 48, 51, 48, 70, 69, 71, 50, 69, 51, 114, 88, 113, 88, 91, 88, 114, 113, 115, 90, 113, 91, 162, 136, 161, 136, 139, 136, 162, 161, 163, 138, 161, 139, 214, 184, 213, 184, 187, 184, 214, 213, 215, 186, 213, 187, 118, 92, 117, 92, 95, 92, 118, 117, 119, 94, 117, 95, 166, 140, 165, 140, 143, 140, 166, 165, 167, 142, 165, 143, 218, 188, 217, 188, 191, 188, 218, 217, 219, 190, 217, 191, 250, 232, 249, 232, 235, 232, 250, 249, 251, 234, 249, 235, 282, 264, 281, 264, 267, 264, 282, 281, 283, 266, 281, 267, 222, 192, 221, 192, 195, 192, 222, 221, 223, 194, 221, 195, 254, 236, 253, 236, 239, 236, 254, 253, 255, 238, 253, 239, 286, 268, 285, 268, 271, 268, 286, 285, 287, 270, 285, 271, 314, 296, 313, 296, 299, 296, 314, 313, 315, 298, 313, 299, 338, 324, 337, 324, 327, 324, 338, 337, 339, 326, 337, 327, 318, 300, 317, 300, 303, 300, 318, 317, 319, 302, 317, 303, 342, 328, 341, 328, 331, 328, 342, 341, 343, 330, 341, 331, 358, 348, 357, 348, 351, 348, 358, 357, 359, 350, 357, 351], "opacity": 1, "type": "mesh3d", "x": [-4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -4.016320668186614, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.253477083952596, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -3.2034770839525963, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.4406334997185786, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -2.390633499718579, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.6277899154845616, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -1.577789915484562, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.8149463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.7649463312505445, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, -0.002102747016526907, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.04789725298347314, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8107408372174907, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 0.8607408372174898, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6235844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 1.6735844214515074, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.436428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 2.486428005685525, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.249271589919543, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 3.2992715899195426, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356, 4.06211517415356], "y": [1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 3.8549731900120006, 3.8549731900120006, 5.674403403703017, 5.674403403703017, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 1.9855429763209842, 1.9855429763209842, 3.8049731900120003, 3.8049731900120003, 5.7244034037030165, 5.7244034037030165, 7.543833617394033, 7.543833617394033, 7.593833617394033, 7.593833617394033, 9.413263831085048, 9.413263831085048, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 0.11611276262996784, 0.11611276262996784, 1.9355429763209842, 1.9355429763209842, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 9.46326383108505, 9.46326383108505, 11.282694044776065, 11.282694044776065, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, -1.7533174510610485, -1.7533174510610485, 0.06611276262996779, 0.06611276262996779, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 11.332694044776066, 11.332694044776066, 13.152124258467081, 13.152124258467081, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581, -3.622747664752065, -3.622747664752065, -1.8033174510610486, -1.8033174510610486, 13.202124258467084, 13.202124258467084, 15.0215544721581, 15.0215544721581], "z": [0.0, 4.0, 0.0, 4.0, 0.0, 84.0, 0.0, 84.0, 0.0, 81.0, 0.0, 81.0, 0.0, 2.0, 0.0, 2.0, 0.0, 4.0, 0.0, 4.0, 0.0, 84.0, 0.0, 84.0, 0.0, 81.0, 0.0, 81.0, 0.0, 2.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 266.0, 0.0, 266.0, 0.0, 1201.0, 0.0, 1201.0, 0.0, 1204.0, 0.0, 1204.0, 0.0, 170.0, 0.0, 170.0, 0.0, 1.0, 0.0, 1.0, 0.0, 266.0, 0.0, 266.0, 0.0, 1201.0, 0.0, 1201.0, 0.0, 1204.0, 0.0, 1204.0, 0.0, 170.0, 0.0, 170.0, 0.0, 50.0, 0.0, 50.0, 0.0, 998.0, 0.0, 998.0, 0.0, 1429.0, 0.0, 1429.0, 0.0, 1481.0, 0.0, 1481.0, 0.0, 817.0, 0.0, 817.0, 0.0, 28.0, 0.0, 28.0, 0.0, 50.0, 0.0, 50.0, 0.0, 998.0, 0.0, 998.0, 0.0, 1429.0, 0.0, 1429.0, 0.0, 1481.0, 0.0, 1481.0, 0.0, 817.0, 0.0, 817.0, 0.0, 28.0, 0.0, 28.0, 0.0, 234.0, 0.0, 234.0, 0.0, 449.0, 0.0, 449.0, 0.0, 107.0, 0.0, 107.0, 0.0, 128.0, 0.0, 128.0, 0.0, 459.0, 0.0, 459.0, 0.0, 188.0, 0.0, 188.0, 0.0, 234.0, 0.0, 234.0, 0.0, 449.0, 0.0, 449.0, 0.0, 107.0, 0.0, 107.0, 0.0, 128.0, 0.0, 128.0, 0.0, 459.0, 0.0, 459.0, 0.0, 188.0, 0.0, 188.0, 0.0, 22.0, 0.0, 22.0, 0.0, 189.0, 0.0, 189.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 0.0, 1.0, 0.0, 26.0, 0.0, 26.0, 0.0, 175.0, 0.0, 175.0, 0.0, 4.0, 0.0, 4.0, 0.0, 22.0, 0.0, 22.0, 0.0, 189.0, 0.0, 189.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 0.0, 1.0, 0.0, 26.0, 0.0, 26.0, 0.0, 175.0, 0.0, 175.0, 0.0, 4.0, 0.0, 4.0, 0.0, 33.0, 0.0, 33.0, 0.0, 31.0, 0.0, 31.0, 0.0, 34.0, 0.0, 34.0, 0.0, 22.0, 0.0, 22.0, 0.0, 33.0, 0.0, 33.0, 0.0, 31.0, 0.0, 31.0, 0.0, 34.0, 0.0, 34.0, 0.0, 22.0, 0.0, 22.0, 0.0, 1.0, 0.0, 1.0, 0.0, 18.0, 0.0, 18.0, 0.0, 1.0, 0.0, 1.0, 0.0, 21.0, 0.0, 21.0, 0.0, 1.0, 0.0, 1.0, 0.0, 18.0, 0.0, 18.0, 0.0, 1.0, 0.0, 1.0, 0.0, 21.0, 0.0, 21.0, 0.0, 1.0, 0.0, 1.0, 0.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 1.0, 0.0, 1.0, 0.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 3.0, 0.0, 3.0, 0.0, 2.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 2.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0]}],
                        {"height": 700, "hovermode": false, "scene": {"camera": {"eye": {"x": -1.25, "y": 1.25, "z": 1.25}}}, "showlegend": false, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"x": 0.5}, "width": 650},
                        {"displayModeBar": false, "scrollZoom": false, "responsive": true}
                    )
                };
                
            </script>
        </div>
</body>
</html>
</div>
<p>A visualization solution that requires less technology would start the same way,
i.e., by dividing the <span class="math inline">\(xy\)</span> plane into regions, but instead of the third
dimension, it would use different colors to represent the counts. Here is an
example where the regions are hexagons, as opposed to squares; it just looks
better, for some reason:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Just to showcase the range of possibilities, here is another visualization
technique which which requires deeper statistical tools, namely the
<strong>density contour plot</strong>:
<img src="_main_files/figure-html/unnamed-chunk-80-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><em>Comments (R):</em> There is very little new R here. You should remember that if <code>x</code> and <code>y</code> are
vectors of the same length, <code>plot(x,y)</code> gives you a scatterplot of <code>x</code> and <code>y</code>.</p>
<p>To compute the sample correlation between two vectors, use the <code>cor</code>.</p>
<p>We used the command <code>sample(y)</code> to obtain a randomly permuted version of <code>y</code>.
The simplicity of this is due to default parameters of the command <code>sample</code>
which we already learned about. In particular, the default number of samples is
exactly the size of the input vector <code>y</code> and, by default, sampling is performed
<em>without replacement</em>. If you think about it for a second, you will realize that
a sample of size <span class="math inline">\(n\)</span> from the vector of size <span class="math inline">\(n\)</span> <em>without</em> replacement is
nothing by a random permutation of <code>y</code>.</p>
<p>You are not required to do this in your submissions, but if you want to display
several plots side-by-side, use the command <code>par(mfrow=c(m,n))</code> before the command
<code>plot</code>. It tells R to plot the next <span class="math inline">\(mn\)</span> plots in a <span class="math inline">\(m\times n\)</span> grid.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-17" class="exercise"><strong>Problem 2.7  </strong></span>Let the random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the joint distribution given by
the following table:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;text-align: center;font-weight: bold;">
1
</td>
<td style="text-align:right;text-align: center;">
0.1
</td>
<td style="text-align:right;text-align: center;">
0.2
</td>
<td style="text-align:right;text-align: center;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
</tbody>
</table>
<p>Simulate <span class="math inline">\(10,000\)</span> draws from the distribution of <span class="math inline">\((X,Y)\)</span> and display a
contingency table of your results.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-18" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-1" aria-hidden="true" tabindex="-1"></a>joint_distribution_long <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb60-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb60-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-5" aria-hidden="true" tabindex="-1"></a>probabilities_long <span class="ot">=</span> </span>
<span id="cb60-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.0</span>)</span>
<span id="cb60-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-8" aria-hidden="true" tabindex="-1"></a>sampled_rows <span class="ot">=</span> <span class="fu">sample</span>(</span>
<span id="cb60-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(joint_distribution_long),</span>
<span id="cb60-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">size =</span> <span class="dv">10000</span>,</span>
<span id="cb60-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">prob =</span> probabilities_long</span>
<span id="cb60-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-15" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">=</span> joint_distribution_long[sampled_rows, ]</span>
<span id="cb60-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(draws)</span>
<span id="cb60-18"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    y</span></span>
<span id="cb60-19"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="do">## x      1    2    3</span></span>
<span id="cb60-20"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   1  962 2027 3047</span></span>
<span id="cb60-21"><a href="simulation-of-random-variables-and-monte-carlo.html#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   2 1945 2019    0</span></span></code></pre></div>
<p><em>Comments (Math):</em> The main mathematical idea is to think of <em>each pair</em> of possible values
of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as a separate “object”, put all these objects in a “bag”, then
then draw from the bag. In other words, we convert the bivariate distribution
from the problem to the following univariate distribution</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
(1,1)
</th>
<th style="text-align:right;">
(1,2)
</th>
<th style="text-align:right;">
(1,3)
</th>
<th style="text-align:right;">
(2,1)
</th>
<th style="text-align:right;">
(2,2)
</th>
<th style="text-align:right;">
(2,3)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>and sample from it. When you do, you will get a vector whose elements are pairs
of numbers. The last step is to extract the components of those pairs into
separate vectors.</p>
<p><em>Comments (R):</em> The most important new R concept here is <code>data.frame</code>. You should think of
it as a spreadsheet. It is, mathematically, a matrix, but we do not perform any
mathematical operations on it. Moreover, not all columns in the data frame have
to be numeric. Some of them can be strings, and other can be something even more
exotic. You should think of a data frame as a bunch of column vectors of the
same length stacked side by side. It is important to note that each column of a
data frame will have a name, so that we don’t have to access it by its position
only (as we would have to in the case of a matrix).</p>
<p>In this class, the column vectors of data frames are going to contain simulated
values. In statistics, it is data that comes in data frames, with rows
corresponding to different observations, and columns to various observed
variables.</p>
<p>The easiest way to construct a data frame using already existing vectors is as follows:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb61-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb61-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb61-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)</span>
<span id="cb61-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb61-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">df=</span><span class="fu">data.frame</span>(x,y))</span>
<span id="cb61-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   x y</span></span>
<span id="cb61-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 1 a</span></span>
<span id="cb61-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 2 b</span></span>
<span id="cb61-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 3 c</span></span></code></pre></div>
<p>Note that the two columns inherited their names from the vectors <code>x</code> and <code>y</code>
that fed into them. Note, also, that all rows got consecutive numerical values
as names by default. Row names are sometimes useful to have, but are in general
a nuisance and should be ignored (especially in this class). Column names are
more important, and there is a special notation (the dollar-sign notation) that
allows you to access a column by its name:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb62-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>y</span>
<span id="cb62-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</span></span></code></pre></div>
<p>If you want to give your columns custom names (or if you are building them out
of explicitly given vectors as in the solution above) use the following syntax</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb63-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>)</span>
<span id="cb63-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb63-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">df =</span> <span class="fu">data.frame</span>( <span class="at">letters =</span> z, <span class="at">numbers =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)))</span>
<span id="cb63-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   letters numbers</span></span>
<span id="cb63-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1       a       1</span></span>
<span id="cb63-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       b       2</span></span>
<span id="cb63-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3       c       3</span></span>
<span id="cb63-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4       d       4</span></span></code></pre></div>
<p>A feature that data frames share with vectors and matrices is that you can use vector indexing as in the following example (where <code>df</code> is as above)</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb64-1" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>),]</span>
<span id="cb64-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="do">##     letters numbers</span></span>
<span id="cb64-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 2         b       2</span></span>
<span id="cb64-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 4         d       4</span></span>
<span id="cb64-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 4.1       d       4</span></span>
<span id="cb64-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1         a       1</span></span></code></pre></div>
<p>Make sure you understand why the expression inside the brackets is <code>c(2,4,4,1),</code>
and not <code>c(2,4,4,1)</code>. R’s desire to keep row names unique leads to some
cumbersome constructs such as <code>4.1</code> above. As I mentioned before, just disregard
them.</p>
<p>A nice thing about data frames is that they can easily be pretty-printed in
RStudio. Go to the Environment tab in one of your RStudio panes, and double
click on the name of the data frame you just built. It will appear as a nicely
formatted spreadsheet.</p>
<p>Once we have the data frame containing all <span class="math inline">\(6\)</span> pairs of possible values <span class="math inline">\(X\)</span> and
<span class="math inline">\(Y\)</span> can take (called <code>joint_distribution_long</code> in the solution above), we can
proceed by sampling from its rows, by sampling from the set <code>1,2,3,4,5,6</code> with
probabilities <code>0.1, 0.2, 0.3, 0.2, 0.2, 0.0</code>. The result of the corresponding
<code>sample</code> command will be a sequence - called <code>sampled_rows</code> in the solution - of
length <span class="math inline">\(10,000\)</span> composed of numbers <span class="math inline">\(1,2,3,4,5\)</span> or <span class="math inline">\(6\)</span>. The reason we chose the
name <code>sampled_rows</code> is because each number corresponds to a row from the data
frame <code>joint_distribution_long</code>, and by indexing <code>joint_distribution_long</code> by
<code>sampled_rows</code> we are effectively sampling from its rows. In other words, the
command <code>joint_distribution_long[sampled_rows, ]</code> turns a bunch of numbers into
a bunch of rows (many of them repeated) of the data frame
<code>joint_distribution_long</code>.</p>
<p>The final step is to use the function <code>table</code>. This time, we are applying it to
a data frame and not to a vector, but the effect is the same. It tabulates all
possible combinations of values of the columns, and counts how many times each
of them happened. The same result would have been obtained by calling
<code>table(draws$x, draws$y)</code>.</p>
</div>
</div>
<div id="monte-carlo" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Monte Carlo<a href="simulation-of-random-variables-and-monte-carlo.html#monte-carlo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-19" class="exercise"><strong>Problem 2.8  </strong></span>Use Monte Carlo to estimate the expected value of the exponential random
variable with parameter <span class="math inline">\(\lambda= 4\)</span> using <span class="math inline">\(n=10\)</span>, <span class="math inline">\(n=1,000\)</span> and <span class="math inline">\(n=1,000,000\)</span>
simulations. Compare to the exact value.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-20" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb65-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">10</span>, <span class="at">rate=</span><span class="dv">4</span>)</span>
<span id="cb65-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb65-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1779768</span></span></code></pre></div>
<p>For an exponential random variable with parameter <span class="math inline">\(\lambda\)</span>, the expected value is
<span class="math inline">\(1/\lambda\)</span> (such information can be found in <a href="./dist.html">Appendix A</a>) which,
in this case, is <span class="math inline">\(0.25\)</span>. The error made was 0.072023 for <span class="math inline">\(n=10\)</span> simulations.</p>
<p>We increase the number of simulations to <span class="math inline">\(n=1000\)</span> and get a better result</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb66-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, <span class="at">rate=</span><span class="dv">4</span>)</span>
<span id="cb66-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb66-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2564643</span></span></code></pre></div>
<p>with (smaller) error -0.0064643. Finally, let’s try <span class="math inline">\(n=1,000,000\)</span>:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb67-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">1000000</span>, <span class="at">rate=</span><span class="dv">4</span>)</span>
<span id="cb67-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb67-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.250381</span></span></code></pre></div>
<p>The error is even smaller -0.00038101.</p>
<!-- This can be obtained quite easily by integration (by parts): -->
<!-- $$ \EE[X] = \int_{-\infty}^{\infty} x f(x)\, dx = \int_0^{\infty} x \ld e^{-\ld x}\, dx = \tfrac{1}{\ld}$$ -->
<p><em>Comments (R):</em> The only new thing here is the command <code>mean</code> which computes the mean of a vector.</p>
<p><em>Comments (Math):</em> There is a lot going on here conceptually. This is the first time we
used the Monte Carlo method. It is an incredibly useful tool, as you will keep
being reminded throughout this class. The idea behind it is simple, and it is
based on the <em>Law of large numbers</em>:</p>
<p><strong>Theorem</strong> Let <span class="math inline">\(X_1,X_2, \dots\)</span> be an independent sequence of random
variables with the same distribution, for which the expected value can be
computed. Then
<span class="math display">\[ \tfrac{1}{n} \Big( X_1+X_2+\dots+X_n\Big) \to {\mathbb{E}}[X_1] \text{ as } n\to\infty\]</span>
The idea behind Monte Carlo is to turn this theorem “upside down”. The goal is
to compute <span class="math inline">\({\mathbb{E}}[X_1]\)</span> and use a supply of random numbers, each of which
comes from the same distribution, to accomplish that. The random number
generator inside <code>rexp</code> gives us a supply of numbers (stored in the vector <code>x</code>)
and all we have to do is compute their average. This gives us the left-hand side
of the formula above, and, if <span class="math inline">\(n\)</span> is large enough, we hope that this average
does not differ too much from its theoretical limit. As <span class="math inline">\(n\)</span> gets larger, we
expect better and better results. That is why your error above gets smaller as
<span class="math inline">\(n\)</span> increases.</p>
<p>It looks like Monte Carlo can only be used to compute the expected value of a
random variable, which does not seem like such a bit deal. But it is! You will see
in the sequel that almost anything can be written as the expected value of
<em>some</em> random variable.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-21" class="exercise"><strong>Problem 2.9  </strong></span>Use Monte Carlo to estimate <span class="math inline">\({\mathbb{E}}[X^2]\)</span>, where <span class="math inline">\(X\)</span> is a standard normal
random variable.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-22" class="solution"><em>Solution</em>. </span>You may or may now know that when <span class="math inline">\(X\)</span> is standard normal <span class="math inline">\(Y=X^2\)</span> has a <span class="math inline">\(\chi^2\)</span>
distribution with one degree of freedom. If you do, you can solve the problem
like this:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb68-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rchisq</span>(<span class="dv">5000</span> ,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb68-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb68-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9771929</span></span></code></pre></div>
<p>If you don’t, you can do the following:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb69-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">5000</span>)</span>
<span id="cb69-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb69-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb69-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb69-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.019852</span></span></code></pre></div>
<p><em>Comments (Math+R):</em> We are asked to compute <span class="math inline">\({\mathbb{E}}[ X^2]\)</span>, which can be interpreted in
two ways. First, we can think of <span class="math inline">\(Y=X^2\)</span> as a random variable in its own right and you
can try to take draws from the distribution of <span class="math inline">\(Y\)</span>. In the case of the normal
distribution, the distribution of <span class="math inline">\(Y\)</span> is known - it happens to be a
<span class="math inline">\(\chi^2\)</span>-distribution with a single degree of freedom (don’t worry if you never
heard of it). We can simulate it in R by using its R name <code>chisq</code> and
get a number close to the exact value of <span class="math inline">\(1\)</span>.</p>
<p>If you did not know about the <span class="math inline">\(\chi^2\)</span> distribution, you would not know what R
name to put the prefix <code>r</code> in front of. What makes the simulation possible is
the fact that <span class="math inline">\(Y\)</span> is a <em>transformation</em> of
a random variable we know how to simulate. In that case, we simply simulate the
required number of draws <code>x</code> from the normal distribution (using <code>rnorm</code>) and
then apply the transformation <span class="math inline">\(x \mapsto x^2\)</span> to the result. The transformed
vector <code>y</code> is then nothing but the sequence of draws from the distribution of
<span class="math inline">\(X^2\)</span>.</p>
<p>The idea described above is one of main advantages of the Monte Carlo technique:
if you know how to simulate a random variable, you also know how to simulate
any (deterministic) function of it. That fact will come into its own a bit later
when we start working with several random variables and stochastic processes,
but it can be very helpful even in the case of a single random variable, as you
will see in the next problem.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-23" class="exercise"><strong>Problem 2.10  </strong></span>Let <span class="math inline">\(X\)</span> be a standard normal random variable. Use Monte Carlo to estimate the
probability <span class="math inline">\({\mathbb{P}}[ X &gt; 1 ]\)</span>. Compare to the exact value.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-24" class="solution"><em>Solution</em>. </span>The estimated probability:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb70-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb70-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb70-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb70-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb70-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">p_est =</span> <span class="fu">mean</span>(y))</span>
<span id="cb70-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1608</span></span></code></pre></div>
<p>The exact probability and the error</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb71-1" aria-hidden="true" tabindex="-1"></a>p_true <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>)</span>
<span id="cb71-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb71-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">err =</span> p_est<span class="sc">-</span>p_true)</span>
<span id="cb71-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.002144746</span></span></code></pre></div>
<p><em>Comments (R):</em> As we learned before, the symbol <code>&gt;</code> is an operation, which returns a Boolean (<code>TRUE</code> or <code>FALSE</code>) value. For example:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">&gt;</span><span class="dv">2</span></span>
<span id="cb72-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">^</span><span class="dv">2</span><span class="sc">&gt;</span><span class="dv">20</span></span>
<span id="cb73-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<p>It is vectorized:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb74-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb74-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb74-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">3</span>)</span>
<span id="cb74-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb74-3" aria-hidden="true" tabindex="-1"></a>x<span class="sc">&gt;</span>y</span>
<span id="cb74-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] FALSE  TRUE  TRUE</span></span></code></pre></div>
<p>and recycling rules apply to it (so that you can compare a vector and a scalar, for example)</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb75-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb75-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb75-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">&gt;</span><span class="dv">5</span></span>
<span id="cb75-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</span></span></code></pre></div>
<p>Therefore, the vector <code>y</code> in the solution is a vector of length <span class="math inline">\(10000\)</span> whose
elements are either <code>TRUE</code> or <code>FALSE</code>; here are the first 5 rows of data frame
with columns <code>x</code> and <code>y</code> from our solution:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:left;">
y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.9493
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.1015
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
1.0448
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1384
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2573
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
</tbody>
</table>
<p>Finally, <code>z</code> contains the <code>mean</code> of <code>y</code>. How do you compute a mean of Boolean values? In R (and many other languages) <code>TRUE</code> and <code>FALSE</code> have default numerical values, usually <span class="math inline">\(1\)</span> and <span class="math inline">\(0\)</span>. This way, when <span class="math inline">\(R\)</span> is asked to compute the <code>sum</code> of a Boolean vector it will effectively count the number of values which are <code>TRUE</code>. Similarly, the <code>mean</code> is the relative proportion of <code>TRUE</code> values.</p>
<p><em>Comments (Math):</em> We computed the <strong>proportion</strong> of the “times” <span class="math inline">\(X&gt;1\)</span> (among many simulations of <span class="math inline">\(X\)</span>) and used it to approximate the <strong>probability</strong> <span class="math inline">\({\mathbb{P}}[ X&gt;1]\)</span>. More formally,
we started from a random variable <span class="math inline">\(X\)</span> with a normal distribution and then transformed it into another random variable, <span class="math inline">\(Y\)</span>, by setting <span class="math inline">\(Y=1\)</span> whenever <span class="math inline">\(X&gt;1\)</span> and <span class="math inline">\(0\)</span> otherwise. This is often written as follows
<span class="math display">\[ Y = \begin{cases} 1, &amp; X&gt;1 \\ 0, &amp; X\leq 1.\end{cases}\]</span>
The random variable <span class="math inline">\(Y\)</span> is very special - it can only take values <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (i.e., its support is <span class="math inline">\(\{0,1\}\)</span>). Such random variables are called <strong>indicator random variables</strong>, and their distribution, called the <strong>Bernoulli distribution</strong>, always looks like this:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
0
</th>
<th style="text-align:left;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1-p
</td>
<td style="text-align:left;">
p
</td>
</tr>
</tbody>
</table>
<p>for some <span class="math inline">\(p \in [0,1]\)</span>. The parameter <span class="math inline">\(p\)</span> is nothing but the probability <span class="math inline">\({\mathbb{P}}[Y=1]\)</span>.</p>
<p>So why did we decide to transform <span class="math inline">\(X\)</span> into <span class="math inline">\(Y\)</span>? Because of the following simple fact:
<span class="math display">\[ {\mathbb{E}}[ Y] = 1 \times p + 0 \times (1-p) = p.\]</span>
The expected value of an indicator is the probability <span class="math inline">\(p\)</span>, and we know that we can use Monte Carlo whenever we can express the quantity we are computing as an expected value of a random variable we know how to simulate.</p>
</div>
<p>Many times, simulating a random variable is easier than analyzing it analytically. Here is a fun example:</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-25" class="exercise"><strong>Problem 2.11  </strong></span>Use Monte Carlo to estimate the value of <span class="math inline">\(\pi\)</span> and compute the error.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-26" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">1000000</span></span>
<span id="cb76-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span>  <span class="fu">runif</span>(nsim,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb76-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span>  <span class="fu">runif</span>(nsim,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb76-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> (x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> y <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">&lt;</span> <span class="dv">1</span></span>
<span id="cb76-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-5" aria-hidden="true" tabindex="-1"></a>(<span class="at">pi_est =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">mean</span>(z))</span>
<span id="cb76-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.141728</span></span>
<span id="cb76-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-7" aria-hidden="true" tabindex="-1"></a>(<span class="at">err =</span> pi_est <span class="sc">-</span> pi)</span>
<span id="cb76-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.0001353464</span></span></code></pre></div>
<p><em>Comments (Math):</em>
<img src="pics/mc_pi.gif" width="50%" style="float:right; padding:10px" style="display: block; margin: auto;" />
As we learned in the previous problem, probabilities of events can be computed using Monte Carlo, as long as we know how to simulate the underlying indicator random variable. In this case, we want to compute <span class="math inline">\(\pi\)</span>, so we would need to find a “situation” in which the probability of something is <span class="math inline">\(\pi\)</span>. Of course, <span class="math inline">\(\pi&gt;1\)</span>, so it cannot be a probability of anything, but <span class="math inline">\(\pi/4\)</span> can, and computing <span class="math inline">\(\pi/4\)</span> is as useful as computing <span class="math inline">\(\pi\)</span>. To create the required probabilistic “situation” we think of the geometric meaning of <span class="math inline">\(\pi\)</span>, and come up with the following scheme. Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be two independent uniform random variables each with values between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>. We can think of the pair <span class="math inline">\((X,Y)\)</span> as a random point in the square <span class="math inline">\([-1,1]\times [-1,1]\)</span>. This point will sometimes fall inside the unit circle, and sometimes it will not. What is the probability of hitting the circle? Well, since <span class="math inline">\((X,Y)\)</span> is uniformly distributed everywhere inside the square, this probability should be equal to the portion of the area of our square which belongs to the unit circle. The area of the square is <span class="math inline">\(4\)</span> and the area of the circle is <span class="math inline">\(\pi\)</span>, so the required probability is <span class="math inline">\(\pi/4\)</span>. Using the idea from the previous problem, we define the indicator random variable <span class="math inline">\(Z\)</span> as follows
<span class="math display">\[ Z = \begin{cases} 1 &amp; (X,Y) \text{ is inside the unit circle, } \\ 0 &amp; \text{ otherwise.}
\end{cases}
= \begin{cases} 1&amp; X^2+Y^2 &lt; 1, \\ 0 &amp; \text{ otherwise.} \end{cases}\]</span></p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-27" class="exercise"><strong>Problem 2.12  </strong></span> 
1. Write an R function <code>cumavg</code> which computes the sequence of running averages of a vector, i.e., if the input is <span class="math inline">\(x=(x_1,x_2,x_3,\dots, x_n)\)</span>, the output should be
<span class="math display">\[ \Big(x_1, \frac{1}{2} (x_1+x_2), \frac{1}{3}(x_1+x_2+x_3), \dots, \frac{1}{n} (x_1+x_2+\dots+x_n)\Big).\]</span> Test it to check that it really works. (<em>Hint:</em> look up the function <code>cumsum</code>. )</p>
<ol start="2" style="list-style-type: decimal">
<li>Apply <code>cumavg</code> to the vector <span class="math inline">\(4 z\)</span> from the previous problem and plot your results (use a smaller value for <code>nsim</code>. Maybe <span class="math inline">\(1000\)</span>.) Plot the values against their index. Add a red horizontal line at the level <span class="math inline">\(\pi\)</span>. Rerun the same code (including the simulation part) several times.</li>
</ol>
</div>
<div class="solution">
<p><span id="unlabeled-div-28" class="solution"><em>Solution</em>. </span> </p>
<ol style="list-style-type: decimal">
<li>Once you know about the function <code>cumsum</code>, the problem becomes much easier.</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-1" aria-hidden="true" tabindex="-1"></a>cumavg <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb77-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-2" aria-hidden="true" tabindex="-1"></a>   c <span class="ot">=</span> <span class="fu">cumsum</span>(x)</span>
<span id="cb77-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-3" aria-hidden="true" tabindex="-1"></a>   n <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)</span>
<span id="cb77-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(c <span class="sc">/</span> n)</span>
<span id="cb77-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">9</span>)</span>
<span id="cb77-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cumavg</span>(x)</span>
<span id="cb77-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3 3 3 4</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb78-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span>  <span class="fu">runif</span>(nsim,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb78-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span>  <span class="fu">runif</span>(nsim,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb78-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> (x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> y <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">&lt;</span> <span class="dv">1</span></span>
<span id="cb78-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-5" aria-hidden="true" tabindex="-1"></a>pi_est <span class="ot">=</span> <span class="fu">cumavg</span>(<span class="dv">4</span> <span class="sc">*</span> z)</span>
<span id="cb78-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb78-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-7" aria-hidden="true" tabindex="-1"></a>   <span class="dv">1</span><span class="sc">:</span>nsim,</span>
<span id="cb78-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-8" aria-hidden="true" tabindex="-1"></a>   pi_est,</span>
<span id="cb78-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb78-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">xlab =</span> <span class="st">&quot;number of simulations&quot;</span>,</span>
<span id="cb78-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">ylab =</span> <span class="st">&quot;estimate of pi&quot;</span>,</span>
<span id="cb78-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">main =</span> <span class="st">&quot;Computing pi by Monte Carlo&quot;</span></span>
<span id="cb78-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(pi, <span class="dv">0</span>,</span>
<span id="cb78-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb78-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Comments (R):</em> This course is not about R graphics, but I think it is a good idea to teach you how to make basic plots in R. We already used the function <code>plot</code> to draw scatterplots.
By default, each point drawn by <code>plot</code> is marked by a small circle so it might not seem like a good idea to use it. Luckily this, and many other things, can be adjusted by numerous additional arguments. One of such arguments is <code>type</code> which determines the type of the plot. We used <code>type="l"</code> which tells R to join the points with straight lines:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb79-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)</span>
<span id="cb79-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb79-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb79-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-105-1.png" width="672" style="display: block; margin: auto;" />
The other arguments, <code>xlab</code>, <code>ylab</code> and <code>main</code> determine labels for axes and the entire plot. The function <code>abline(a,b)</code> adds a line <span class="math inline">\(y = a x + b\)</span> to an already existing plot. It is very useful in statistics if one wants to show the regression line superimposed on the scatterplot of data. Finally, the argument <code>col</code>, of course, determines the color of the line. To learn about various graphical parameters, type <code>?par</code>.</p>
<p><em>Comments (Math):</em> The conceptual reason for this exercise is to explore (numerically) the kinds of errors we make when we use Monte Carlo. Unlike the deterministic numerical procedures, Monte Carlo has a strange property that no bound on the error can be made with absolute certainty. Let me give you an example. Suppose that you have a biased coin, with the probability <span class="math inline">\(0.6\)</span> of heads and <span class="math inline">\(0.4\)</span> of tails. You don’t know this probability, and use a Monte Carlo technique to estimate it - you toss your coin <span class="math inline">\(1000\)</span> times and record the number of times you observe <span class="math inline">\(H\)</span>. The law of large numbers suggests that the relative frequency of heads is close to the true probability of <span class="math inline">\(H\)</span>. Indeed, you run a simulation</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb80-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sample</span>( <span class="fu">c</span>(<span class="st">&quot;T&quot;</span>,<span class="st">&quot;H&quot;</span>), <span class="dv">1000</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb80-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x <span class="sc">==</span> <span class="st">&quot;H&quot;</span></span>
<span id="cb80-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb80-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.594</span></span></code></pre></div>
<p>and get a pretty accurate estimate of <span class="math inline">\(0.594\)</span>. If you run the same code a few more times, you will get different estimates, but all of them will be close to <span class="math inline">\(0.6\)</span>. Theoretically, however, your simulation could have yielded <span class="math inline">\(1000\)</span> Hs, which would lead you to report <span class="math inline">\(p=1\)</span> as the Monte-Carlo estimate. The point is that even though such disasters are theoretically possible, they are exceedingly unlikely. The probability of getting all <span class="math inline">\(H\)</span> in <span class="math inline">\(1000\)</span> tosses of this coin is a number with more than <span class="math inline">\(500\)</span> zeros after the decimal point.</p>
<p>The take-home message is that even though there are no guarantees, Monte Carlo performs well the vast majority of the time. The crucial ingredient, however, is the number of simulations. The plot you were asked to make illustrates exactly that. The function <code>cumavg</code> gives you a whole sequence of Monte-Carlo estimates of the same thing (the number <span class="math inline">\(\pi\)</span>) with different numbers of simulations <code>nsim</code>. For small values of <code>nsim</code> the error is typically very large (and very random). As the number of simulations grows, the situations stabilizes and the error decreases. Without going into the theory behind it, let me only mention is that in the majority of practical applications we have the following relationship:
<span class="math display">\[ error \sim \frac{1}{\sqrt{n}}.\]</span>
In words, if you want to double the precision, you need to quadruple the number of simulations. If you want an extra digit in your estimate, you need to multiply the number of simulations by <span class="math inline">\(100\)</span>. Here is an image where I superimposed <span class="math inline">\(40\)</span> plots like the one you were asked to produce (the dashed lines are <span class="math inline">\(\pm \frac{4}{\sqrt{n}}\)</span>):</p>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="conditional-distributions" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Conditional distributions<a href="simulation-of-random-variables-and-monte-carlo.html#conditional-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-29" class="exercise"><strong>Problem 2.13  </strong></span>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be two independent geometric random variables with parameters <span class="math inline">\(p=0.5,\)</span> and let <span class="math inline">\(Z=X+Y\)</span>. Compute <span class="math inline">\({\mathbb{P}}[ X = 3| Z = 5]\)</span> using simulation. Compare to the exact value.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-30" class="solution"><em>Solution</em>. </span>By simulation:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb81-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">1000000</span></span>
<span id="cb81-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb81-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">rgeom</span>(nsim, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb81-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb81-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">rgeom</span>(nsim, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb81-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb81-4" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">=</span> X <span class="sc">+</span> Y</span>
<span id="cb81-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb81-5" aria-hidden="true" tabindex="-1"></a>X_cond <span class="ot">=</span> X[Z <span class="sc">==</span> <span class="dv">5</span>]</span>
<span id="cb81-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X_cond  <span class="sc">==</span> <span class="dv">3</span>) </span>
<span id="cb81-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1684758</span></span></code></pre></div>
<p>To get the exact value, we start from the definition:
<span class="math display">\[ {\mathbb{P}}[ X = 3 | Z= 5 ] = \frac{{\mathbb{P}}[ X=3 \text{ and }Z=5]}{{\mathbb{P}}[Z=5]} = \frac{{\mathbb{P}}[X=3 \text{ and }Y = 2]}{{\mathbb{P}}[Z=5]}, \]</span>
where the last equality follows from the fact that <span class="math inline">\(\{ X=3 \text{ and } Z=5 \}\)</span> is exactly the same event as <span class="math inline">\(\{ X = 3 \text{ and } Y=2\}\)</span>.
Since <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, we have
<span class="math display">\[{\mathbb{P}}[ X=3 \text{ and }Y=2 ] = {\mathbb{P}}[X=3] \times {\mathbb{P}}[ Y=2] = 2^{-4} 2^{-3} = 2^{-7}.\]</span>
To compute <span class="math inline">\({\mathbb{P}}[ Z = 5]\)</span> we need to split the event <span class="math inline">\(\{ Z = 5 \}\)</span> into events we know how to deal with. Since <span class="math inline">\(Z\)</span> is built from <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, we write
<span class="math display">\[ \begin{align} {\mathbb{P}}[ Z = 5 ] = &amp;{\mathbb{P}}[X=0 \text{ and }Y=5]+ {\mathbb{P}}[ X=1 \text{ and }Y=4] + {\mathbb{P}}[ X=2 \text{ and }Y=3] + \\
&amp;  {\mathbb{P}}[ X=3 \text{ and }Y=2] + {\mathbb{P}}[ X=4 \text{ and }Y=1] + {\mathbb{P}}[ X = 5 \text{ and }Y=0]. \end{align}\]</span>
Each of the individual probabilities in the sum above is <span class="math inline">\(2^{-7}\)</span>, so <span class="math inline">\({\mathbb{P}}[ X = 3 | Z = 5] = \frac{1}{6}\)</span>.
This gives us an error of 0.0018091.</p>
<p><em>Comments (Math):</em> Let us, first, recall what the conditional probability is.
The definition we learn in the probability class is the following <span class="math display">\[ {\mathbb{P}}[A | B]
= \frac{{\mathbb{P}}[A \text{ and }B]}{{\mathbb{P}}[B]},\]</span> as long as <span class="math inline">\({\mathbb{P}}[B]&gt;0\)</span>. The interpretation is
that <span class="math inline">\({\mathbb{P}}[A|B]\)</span> is still the probability of <span class="math inline">\(A\)</span>, but now in the world where <span class="math inline">\(B\)</span>
is guaranteed to happen. Conditioning usually happens when we receive new
information. If someone tells us that <span class="math inline">\(B\)</span> happened, we can disregard everything
in the complement of <span class="math inline">\(B\)</span> and adjust our probability to account for that fact.
First we remove from <span class="math inline">\(A\)</span> anything that belongs to the complement of <span class="math inline">\(B\)</span>, and
recompute the probability <span class="math inline">\({\mathbb{P}}[A \cap B]\)</span>. We also have to divide by <span class="math inline">\({\mathbb{P}}[B]\)</span>
because we want the total probability to be equal to <span class="math inline">\(1\)</span>.</p>
<p>Our code starts as usual, but simulating <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> from the required
distribution, and constructing a new vector <span class="math inline">\(Z\)</span> as their sum. The variable
<code>X_cond</code> is new; we build it from <span class="math inline">\(X\)</span> by removing all the elements whose
corresponding <span class="math inline">\(Z\)</span> is <em>not</em> equal to <span class="math inline">\(5\)</span>. This is an example of what is sometimes
called the <strong>rejection method</strong> in simulation. We simply “reject” all
simulations which do not satisfy the condition we are conditioning on. We can
think of <code>X_cond</code> as bunch of simulations of <span class="math inline">\(X\)</span>, but in the world where <span class="math inline">\(Z=5\)</span>
is guaranteed to happen. Once we have <code>X_cond</code>, we proceed as usual by computing
the relative frequency of the value <span class="math inline">\(3\)</span> among all possible values <span class="math inline">\(X\)</span> can take.
Note that the same <code>X_cond</code> can also be used to compute the conditional
probability <span class="math inline">\({\mathbb{P}}[ X=1| Z=5]\)</span>. In fact, <code>X_cond</code> contains the information about
the entire <strong>conditional distribution of <span class="math inline">\(X\)</span> given <span class="math inline">\(Z=5\)</span></strong>; if we draw a
histogram of <code>X_cond</code>, we will get a good idea of what this distribution looks
like:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-109-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Since <code>X_cond</code> contains only discrete values from <span class="math inline">\(0\)</span> to <span class="math inline">\(5\)</span>, a contingency
table might be a better tool for understanding its distribution:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
4
</th>
<th style="text-align:right;">
5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
7745
</td>
<td style="text-align:right;">
7761
</td>
<td style="text-align:right;">
7691
</td>
<td style="text-align:right;">
7807
</td>
<td style="text-align:right;">
7731
</td>
<td style="text-align:right;">
7604
</td>
</tr>
</tbody>
</table>
<p>The histogram and the table above suggest that the distribution of <span class="math inline">\(X\)</span>, given <span class="math inline">\(Z=5\)</span>, is uniform on <span class="math inline">\(\{0,1,2,3,4,5\}\)</span>. It is - a calculation almost identical to the one we performed above gives that <span class="math inline">\({\mathbb{P}}[ X= i| Z=5] = \frac{1}{6}\)</span> for each <span class="math inline">\(i=0,1,2,3,4,5\)</span>.</p>
<p>One more observation at the end. Note that we drew <span class="math inline">\(n=1,000,000\)</span> simulations this time. While it is probably an overkill for this particular example, conditional probabilities in general require more simulations than unconditional ones. Of course, that is because we reject most of our original draws. Indeed, the size of the vector <code>X_cond</code> is 46339 - more than a <span class="math inline">\(20\)</span>-fold decrease. This fact becomes particularly apparent when we try to use Monte Carlo for conditional distributions associated with <em>continuous</em> random vectors as we will see in out next problem.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-31" class="exercise"><strong>Problem 2.14  </strong></span>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be independent random variables where <span class="math inline">\(X\)</span> has the <span class="math inline">\(N(0,1)\)</span> distribution and <span class="math inline">\(Y\)</span> the exponential distribution with parameter <span class="math inline">\(\lambda=1\)</span>. Find a graphical approximation to the conditional density of <span class="math inline">\(Y\)</span>, given <span class="math inline">\(X+Y\geq 1\)</span>. Repeat the same, but condition on <span class="math inline">\(X+Y=1\)</span>.</p>
</div>
<div class="solution">
<p><span id="unlabeled-div-32" class="solution"><em>Solution</em>. </span> </p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb82-1" aria-hidden="true" tabindex="-1"></a>nsim<span class="ot">=</span><span class="dv">100000</span></span>
<span id="cb82-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb82-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(nsim)</span>
<span id="cb82-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb82-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rexp</span>(nsim)</span>
<span id="cb82-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb82-5" aria-hidden="true" tabindex="-1"></a>cond <span class="ot">=</span> x<span class="sc">+</span>y <span class="sc">&gt;=</span> <span class="dv">1</span></span>
<span id="cb82-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb82-6" aria-hidden="true" tabindex="-1"></a>x_cond<span class="ot">=</span>x[cond]</span>
<span id="cb82-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_cond, <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-111-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb83-1" aria-hidden="true" tabindex="-1"></a>nsim<span class="ot">=</span><span class="dv">100000</span></span>
<span id="cb83-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb83-2" aria-hidden="true" tabindex="-1"></a>eps<span class="ot">=</span><span class="fl">0.1</span></span>
<span id="cb83-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb83-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(nsim)</span>
<span id="cb83-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb83-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rexp</span>(nsim)</span>
<span id="cb83-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb83-5" aria-hidden="true" tabindex="-1"></a>cond <span class="ot">=</span> (<span class="dv">1</span><span class="sc">-</span>eps <span class="sc">&lt;</span> x<span class="sc">+</span>y) <span class="sc">&amp;</span> (x<span class="sc">+</span>y<span class="sc">&lt;</span><span class="dv">1</span><span class="sc">+</span>eps)</span>
<span id="cb83-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb83-6" aria-hidden="true" tabindex="-1"></a>x_cond<span class="ot">=</span>x[cond]</span>
<span id="cb83-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_cond, <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-112-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Comments (Math):</em> In the case of conditioning on <span class="math inline">\(X+Y\geq 1\)</span> we repeated the same procedure as in the discrete case. We simply rejected all draws that do not satisfy the condition.</p>
<p>When Conditioning on <span class="math inline">\(X+Y=1\)</span>, however, you immediately encounter a problem that you don’t get with discrete distributions. The event <span class="math inline">\(\{ X+Y=1\}\)</span> has probability <span class="math inline">\(0\)</span> and will never happen.
That means that our strategy form the previous problem will simply not work - you will reject <strong>all</strong> draws. The problem goes beyond a particular approach to the problem, as the conditional probabilities such as <span class="math inline">\({\mathbb{P}}[ Y \geq 0 | X+Y=1]\)</span> are not well defined. Indeed, the formula
<span class="math display">\[ {\mathbb{P}}[ Y \geq 0 | X+Y=1] &quot;=&quot; \frac{{\mathbb{P}}[ Y\geq 0 \text{ and } X+Y=1]}{ {\mathbb{P}}[X+Y=1]}\]</span>
requires that the probability in the denominator be strictly positive. Otherwise you are dividing by zero. The theoretical solution to this is by no means simple and requires mathematics beyond the scope of these notes. Practically, there is a very simple way of going around it. Instead of conditioning on the zero-probability event <span class="math inline">\(X+Y=1\)</span>, we use a slightly more relaxed condition
<span class="math display">\[ X+Y \in (1-\varepsilon, 1+\varepsilon) \]</span> for a small, but positive, <span class="math inline">\(\varepsilon\)</span>. In many cases of interest, this approximation works very well, as long as <span class="math inline">\(\varepsilon\)</span> is not too big. How big? Well, that will depend on the particular problem, as well as on the number of simulations you are drawing. The best way is to try several values and experiment. For example, if we chose <span class="math inline">\(\varepsilon=0.01\)</span> in our problem, the number of elements in <code>x_cond</code> (i.e., the number of non-rejected draws) would be on the order of <span class="math inline">\(100\)</span>, which may be considered to small to produce an accurate histogram. On the other hand, when <span class="math inline">\(\varepsilon=1\)</span>, your result will be inaccurate because you are conditioning on the event
<span class="math inline">\(0 &lt; X+Y &lt; 2\)</span> which is a poor approximation for <span class="math inline">\(X+Y=1\)</span>. The rule of thumb is to take the smallest <span class="math inline">\(\varepsilon\)</span> you can, while keeping the number of non-rejected draws sufficiently large.</p>
</div>
</div>
<div id="additional-problems-for-chapter-2" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Additional Problems for Chapter 2<a href="simulation-of-random-variables-and-monte-carlo.html#additional-problems-for-chapter-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-33" class="exercise"><strong>Problem 2.15  </strong></span> </p>
<ol style="list-style-type: decimal">
<li><p>Find the Weibull distribution in R’s help system.<!-- ' -->
Simulate <span class="math inline">\(n=10000\)</span> draws from the Weibull distribution with shape parameter <span class="math inline">\(2\)</span> and scale parameter <span class="math inline">\(3\)</span>. Draw a histogram of your simulations.</p></li>
<li><p>Suppose that the vector <code>x</code> contains <span class="math inline">\(n=10000\)</span> simulations from the standard
normal <span class="math inline">\(\mu=0, \sigma=1)\)</span>. Without simulating any new random numbers,
transform it into the vector <code>y</code> such that <code>y</code> is a vector of <span class="math inline">\(n=10000\)</span>
simulations from the normal with <span class="math inline">\(\mu=1\)</span> and <span class="math inline">\(\sigma=0.5\)</span>. Draw histograms
of both <code>x</code> and <code>y</code> on the same plot. (<em>Note:</em> the extra parameter <code>add</code> is
used to superimpose plots. You may want to use different colors, too. Use
the parameter <code>col</code> for that. )</p></li>
<li><p>Starting with <code>x=seq(-3,3,by=0.1)</code>, define the appropriate vector <code>y</code> and
use <code>x</code> and <code>y</code> to plot the graph of the cdf of the standard normal. The
command you want to use is <code>plot</code> with the following extra arguments</p>
<ul>
<li><code>type="l"</code> (to get a smooth line instead of a bunch of points).</li>
<li><code>main="The CDF of the standard normal"</code> (to set the title), and</li>
<li>another argument (which you must look up yourself) that will set the <span class="math inline">\(y\)</span>-axis label to <span class="math inline">\(F(x)\)</span>.</li>
</ul></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-34" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>The R name for the Weibull distribution is <code>weibull</code> and the arguments names corresponding to the shape and scale parameters are <code>shape</code> and <code>scale</code>:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb84-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rweibull</span>(<span class="dv">10000</span>, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">3</span>)</span>
<span id="cb84-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-333-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Let <span class="math inline">\(X\)</span> be a normally distributed random variable, with parameters <span class="math inline">\(\mu_X\)</span> and <span class="math inline">\(\sigma_X\)</span>. When we apply a linear transformation <span class="math inline">\(Y = \alpha X + \beta\)</span> to X, the result <span class="math inline">\(Y\)</span> has a normal distribution again, but with different parameters. These parameters, call them <span class="math inline">\(\mu_Y\)</span> and <span class="math inline">\(\sigma_Y\)</span>, are easily identified by taking the expected value and the variance:</p>
<p><span class="math display">\[\begin{align} \mu_Y &amp; = {\mathbb{E}}[Y] = \alpha {\mathbb{E}}[X] + \beta = \alpha \mu_X + \beta \\
   \sigma_Y^2 &amp; = \operatorname{Var}[Y] = \operatorname{Var}[\alpha X + \beta] = \alpha^2 \operatorname{Var}[X] = \alpha^2 \sigma_X^2
   \end{align}\]</span></p>
<p>In the problem we are given <span class="math inline">\(\mu_X=0\)</span> and <span class="math inline">\(\sigma_X=1\)</span>, so we must take <span class="math inline">\(\alpha = 0.5\)</span> and <span class="math inline">\(\beta=1\)</span> to get <span class="math inline">\(\mu_Y=1\)</span> and <span class="math inline">\(\sigma_Y=0.5\)</span> (note that this is
exactly the opposite of taking <span class="math inline">\(z\)</span>-scores, where we transform a general normal into the standard normal). In R</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb85-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb85-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb85-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<p>Let’s check that the parameters of <code>y</code> are as as required:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb86-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(y))</span>
<span id="cb86-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.002488</span></span>
<span id="cb86-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb86-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sd</span>(y))</span>
<span id="cb86-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.4989339</span></span></code></pre></div></li>
<li><div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb87-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb87-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb87-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">pnorm</span>(x)</span>
<span id="cb87-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;F(x)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;The CDF of the standard normal&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-336-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-35" class="exercise"><strong>Problem 2.16  </strong></span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>Simulate <span class="math inline">\(n=1000\)</span> draws from the distribution whose distribution table is given by</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
<p>2</p>
</th>
<th style="text-align:right;">
<p>4</p>
</th>
<th style="text-align:right;">
<p>8</p>
</th>
<th style="text-align:right;">
<p>16</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
<p>0.2</p>
</td>
<td style="text-align:right;">
<p>0.3</p>
</td>
<td style="text-align:right;">
<p>0.1</p>
</td>
<td style="text-align:right;">
<p>0.4</p>
</td>
</tr>
</tbody>
</table>
<p>Draw a histogram of your results.</p></li>
<li><p>You may have learned in probability how to compute the pdf <span class="math inline">\(f_Y(y)\)</span> of a
transformation <span class="math inline">\(Y=g(X)\)</span> of a random variable with pdf <span class="math inline">\(f_X(x)\)</span>. Suppose
that you forgot how to do that, but have access to <span class="math inline">\(10,000\)</span> simulations from
the distribution of <span class="math inline">\(X\)</span>. How would you get an approximate idea about the
shape of the function <span class="math inline">\(f_Y\)</span>?</p>
<p>More concretely, take <span class="math inline">\(X\)</span> to be exponentially distributed with parameter <span class="math inline">\(1\)</span> and
<span class="math inline">\(g(x) = \sin(x)\)</span> and produce a picture that approximates the pdf <span class="math inline">\(f_Y\)</span> of <span class="math inline">\(Y\)</span>.
(Note: even if you remember how to do this analytically, you will run into a
difficulty. The function <span class="math inline">\(\sin(x)\)</span> is not one-to-one and the method usually
taught in probability classes will not apply. If you learned how to do it in the
many-to-one case of <span class="math inline">\(g(x)= \sin(x)\)</span>, kudos to your instructor!)</p></li>
<li><p>Let <span class="math inline">\(X\)</span> be a random variable with the Cauchy distribution, and <span class="math inline">\(Y = \operatorname{arctan}(X)\)</span>. R allows you to simulate from the Cauchy
distribution, even if you do not know what it is. How would you use that to
make an educated guess as to what the distribution of <span class="math inline">\(Y\)</span> is? To make your
life easier, consider <span class="math inline">\(\tfrac{2}{\pi} Y\)</span> first.</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-36" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li><div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb88-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>), <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-347-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note: given that we are dealing with a discrete distribution,
a contingency table might be a better choice:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
<p>2</p>
</th>
<th style="text-align:right;">
<p>4</p>
</th>
<th style="text-align:right;">
<p>8</p>
</th>
<th style="text-align:right;">
<p>16</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
<p>2044</p>
</td>
<td style="text-align:right;">
<p>2945</p>
</td>
<td style="text-align:right;">
<p>1045</p>
</td>
<td style="text-align:right;">
<p>3966</p>
</td>
</tr>
</tbody>
</table></li>
<li><p>We apply the function <span class="math inline">\(\sin\)</span> to the simulations. The histogram of the obtained values is going to be a good (graphical) approximation to the pdf of the transformed random variable:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb89-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">100000</span>)</span>
<span id="cb89-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb89-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">sin</span>(x)</span>
<span id="cb89-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-349-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>Having learned that histograms look like the pdfs of the underlying distributions, we draw the histogram:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb90-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rcauchy</span>(<span class="dv">10000</span>)</span>
<span id="cb90-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb90-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">atan</span>(x) <span class="sc">*</span> <span class="dv">2</span><span class="sc">/</span>pi</span>
<span id="cb90-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-350-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>It looks uniform (if we replace <span class="math inline">\(10,000\)</span> by
<span class="math inline">\(100,000\)</span>&amp;_t + it will look even more uniform). We
conclude that <span class="math inline">\(2/\pi \arctan(X)\)</span> is probably uniformly
distributed on <span class="math inline">\((-1,1)\)</span>. Hence, <span class="math inline">\(Y = \arctan(X)\)</span> is probably
uniformly distributed on <span class="math inline">\((-\pi/2, \pi/2)\)</span>.</p></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-37" class="exercise"><strong>Problem 2.17  </strong></span>A basic method for obtaining simulations draws from distributions
other than the uniform is the <strong>transformation method</strong>. The idea is
to start with (pseudo) random numbers, i.e., draws from the uniform
<span class="math inline">\(U(0,1)\)</span> distribution, and then apply a function <span class="math inline">\(g\)</span> to each
simulation. The difficulty is, of course, how to choose the right
function <span class="math inline">\(g\)</span>. <br> Let <span class="math inline">\(X\)</span> be a random variable with a continuous and
strictly increasing cdf <span class="math inline">\(F\)</span>. What is the distribution of <span class="math inline">\(Y=F (X)\)</span>? What does that have to do with the transformation method?</p>
<p>(Hint: if you are having difficulty with this problem, feel free to
run some experiments using R. )</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-38" class="solution"><em>Solution</em>. </span>Let us perform an experiment where <span class="math inline">\(X \sim N(0,1)\)</span>. Remembering that the cdf is given by the R function <code>pnorm</code>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb91-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>)</span>
<span id="cb91-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb91-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">pnorm</span>(x)</span>
<span id="cb91-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-359-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This looks like a histogram of a uniform distribution on <span class="math inline">\((0,1)\)</span>.
Let’s try with some other continuous distributions</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">100000</span>)</span>
<span id="cb92-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rcauchy</span>(<span class="dv">100000</span>)</span>
<span id="cb92-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-3" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">100000</span>)</span>
<span id="cb92-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-4" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">100000</span>, <span class="at">shape =</span> <span class="dv">3</span>)</span>
<span id="cb92-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb92-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">pexp</span>(x1))</span>
<span id="cb92-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">pcauchy</span>(x2))</span>
<span id="cb92-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">punif</span>(x3))</span>
<span id="cb92-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">pgamma</span>(x4, <span class="at">shape =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-360-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>All of those point to the same conjecture, namely that <span class="math inline">\(F(X)\)</span> is
uniformly distributed on <span class="math inline">\((0,1)\)</span>.
To prove that, we
take <span class="math inline">\(Y=F(X)\)</span> and try to compute that cdf <span class="math inline">\(F_Y\)</span> of <span class="math inline">\(Y\)</span>:
<span class="math display">\[F_Y(y) = {\mathbb{P}}[ Y \leq y] = {\mathbb{P}}[ F(X) \leq y]\]</span>
Since <span class="math inline">\(F\)</span> is strictly increasing, it admits an inverse <span class="math inline">\(F^{-1}\)</span>.
Moreover, for any <span class="math inline">\(y \in (0,1)\)</span>,
the set of all values of <span class="math inline">\(x\)</span> such that <span class="math inline">\(F(x)\leq y\)</span> (the red range) is
exactly the interval <span class="math inline">\((-\infty, F^{-1}(y)]\)</span> (the blue range), as in
the picture below:</p>
<center>
<p><img src="pics/cdf_plot.png" width="60%" style="padding:10px" style="display: block; margin: auto;" /></p>
</center>
<p>Hence, <span class="math display">\[F_Y(y)={\mathbb{P}}[Y\leq y] = {\mathbb{P}}[ F(X) \leq y] = {\mathbb{P}}[ X \leq F^{-1}(y) ] = F(F^{-1}(y)) = y,
\text{ for } y\in (0,1).\]</span> The cdf <span class="math inline">\(F_Y\)</span> is, therefore, equal to the cdf
of a uniform on <span class="math inline">\((0,1)\)</span>.
Since the cdf uniquely determines the distribution, <span class="math inline">\(Y\)</span> must be uniformly
distributed on <span class="math inline">\((0,1)\)</span>.</p>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-39" class="exercise"><strong>Problem 2.18  (Extra Credit) </strong></span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>Let <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> be two pdfs. We take a constant <span class="math inline">\(\alpha \in (0,1)\)</span> and define the function <span class="math inline">\(f\)</span> by
<span class="math display">\[ f(x) = \alpha f_1(x) + (1-\alpha) f_2(x).\]</span>
The function <span class="math inline">\(f\)</span> is the pdf of a third distribution, which is called the
<strong>mixture of <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> with weights <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(1-\alpha\)</span></strong>.
Assuming that you know how to simulate from the distributions with pdfs <span class="math inline">\(f_1\)</span>
and <span class="math inline">\(f_2\)</span>, how would you draw <span class="math inline">\(10,000\)</span> simulations from the mixture <span class="math inline">\(f\)</span>? Show
your method on the example of a mixture of <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(4,1)\)</span> with
<span class="math inline">\(\alpha=2/3\)</span>. Plot the histogram of the obtained sample (play with the
parameter <code>breaks</code> until you get a nice picture.)</p>
<p>(<em>Hint:</em> start with two vectors, the first containing <span class="math inline">\(10,000\)</span> simulations from
<span class="math inline">\(f_1\)</span> and the second from <span class="math inline">\(f_2\)</span>. Then “toss” <span class="math inline">\(10,000\)</span> biased coins with
<span class="math inline">\(\mathbb{P}[ H ] = \alpha\)</span> … )</p></li>
<li><p>The <strong>double exponential</strong> or
<strong>Laplace</strong> distribution is a continuous probability distribution whose pdf is
given by <span class="math display">\[ \tfrac{1}{2} \exp(-|x|), x\in {\mathbb R}.\]</span> This distribution
is not built into R. How would you produce simulations from the double
exponential using R?</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-40" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>The idea is that before each draw a biased coin (with <span class="math inline">\({\mathbb{P}}[H]=\alpha\)</span>) is
tossed. If <span class="math inline">\(H\)</span> is obtained, we draw from the distribution with pdf <span class="math inline">\(f_1\)</span>.
Otherwise, we draw from the distribution with pdf <span class="math inline">\(f_2\)</span>. We write a function
which performs one such simulation, and then use the command <code>replicate</code> to
call it several times and store the results in the vector:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-1" aria-hidden="true" tabindex="-1"></a>single_draw <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb93-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-2" aria-hidden="true" tabindex="-1"></a>    coin <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb93-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (coin <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb93-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>)) <span class="cf">else</span> <span class="fu">return</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb93-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-7" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">20000</span></span>
<span id="cb93-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">replicate</span>(nsim, <span class="fu">single_draw</span>())</span>
<span id="cb93-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-369-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As you can see, the histogram has two “humps”, one centered around
<span class="math inline">\(0\)</span> and the
other centered around <span class="math inline">\(4\)</span>. The first one is taller, which reflects the higher
weight (<span class="math inline">\(\alpha=2/3\)</span>) that <span class="math inline">\(N(0,1)\)</span> has in this mixture.</p>
<p>If you wanted to write a more succinct vectorized code (which is not
necessarily faster in this case), you could also do something like this</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb94-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb94-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb94-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb94-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb94-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rnorm</span>(nsim)</span>
<span id="cb94-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb94-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rnorm</span>(nsim, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb94-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb94-5" aria-hidden="true" tabindex="-1"></a>coin <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">size =</span> nsim, <span class="at">prob =</span> <span class="fu">c</span>(alpha, <span class="dv">1</span> <span class="sc">-</span> alpha), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb94-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">ifelse</span>(coin, x1, x2)</span></code></pre></div>
<p>The function <code>ifelse</code> is a vectorized version of the <code>if-then</code> blok and takes
three arguments of equal length. The first one is a vector of logical values
<code>c</code>, and the other two, <code>x1, x2</code> only need to be of the same type. The result
of is a vector whose value at the position <code>i</code> is <code>x1[i]</code> if <code>c[i]==TRUE</code> and
<code>x2[i]</code> otherwise.</p></li>
<li><p>The Laplace distribution can be understood as a mixture, with <span class="math inline">\(\alpha=1/2\)</span>, of
two distributions. The first one is an exponential, and the second one is obtained
from by putting the minus sign in front of it.<br />
Using our strategy from part 1. above,
we could get simulations of it as follows:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb95-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb95-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb95-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb95-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb95-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rexp</span>(nsim)</span>
<span id="cb95-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb95-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="sc">-</span><span class="fu">rexp</span>(nsim)  <span class="co"># note the minus sign in front of rexp</span></span>
<span id="cb95-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb95-5" aria-hidden="true" tabindex="-1"></a>coin <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">size =</span> nsim, <span class="at">prob =</span> <span class="fu">c</span>(alpha, <span class="dv">1</span> <span class="sc">-</span> alpha), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb95-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">ifelse</span>(coin, x1, x2)</span>
<span id="cb95-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-371-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can do this more efficiently if you realize that every time we toss a
coin and choose between <code>x1</code> and <code>x2</code>, we are really choosing the sign in
front of an exponentially distributed random variable. In other words, we can
use <code>coin</code> as a vector of random signs for a vector or draws from the
exponential distribution:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb96-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb96-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb96-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb96-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb96-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(nsim)</span>
<span id="cb96-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb96-4" aria-hidden="true" tabindex="-1"></a>coin <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">size =</span> nsim, <span class="at">prob =</span> <span class="fu">c</span>(alpha, <span class="dv">1</span> <span class="sc">-</span> alpha), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb96-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb96-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> coin <span class="sc">*</span> x</span>
<span id="cb96-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-372-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-41" class="exercise"><strong>Problem 2.19  </strong></span>Let <code>x=rnorm(1000)</code> and <code>y=rnorm(1000)</code>. For each of the following pairs, use the permutation test to decide whether they are independent or not</p>
<ol style="list-style-type: lower-alpha">
<li><code>x^2+y^2</code> and <code>y^2</code></li>
<li><code>(x+y)/sqrt(2)</code> and <code>(x-y)/sqrt(2)</code></li>
<li><code>x</code> and <code>1</code></li>
<li><code>x^2+y^2</code> and <code>atan(y/x)</code>.</li>
</ol>
<p>(Note: do not worry about dividing by <span class="math inline">\(0\)</span> in d. It will happen with probability <span class="math inline">\(0\)</span>.)</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-42" class="solution"><em>Solution</em>. </span>Let us start by writing a function to save some keystrokes</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-1" aria-hidden="true" tabindex="-1"></a>permutation_test <span class="ot">=</span> <span class="cf">function</span>(z, w) {</span>
<span id="cb97-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb97-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(z, w, <span class="at">asp =</span> <span class="dv">1</span>)</span>
<span id="cb97-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(z, <span class="fu">sample</span>(w), <span class="at">asp =</span> <span class="dv">1</span>)</span>
<span id="cb97-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(z, <span class="fu">sample</span>(w), <span class="at">asp =</span> <span class="dv">1</span>)</span>
<span id="cb97-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(z, <span class="fu">sample</span>(w), <span class="at">asp =</span> <span class="dv">1</span>)</span>
<span id="cb97-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb97-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb97-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutation_test</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>, y<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-382-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The first plot is very different from the other three. Therefore,the vectors are probably <em>not</em> independent.</p></li>
<li><div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutation_test</span>((x <span class="sc">+</span> y)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>), (x <span class="sc">-</span> y)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-383-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The first plot could easily be confused for one of the other three. Therefore the vectors are probably independent.</p></li>
<li><div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we have to use rep(1,length(x)) to get a vector of 1s of the same length as</span></span>
<span id="cb100-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># x.  R will not recycle it properly if you simply write 1.  Another, more</span></span>
<span id="cb100-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;hacky&#39; way would be to take advantage of recycling and use 0*x+1</span></span>
<span id="cb100-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">permutation_test</span>(x, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-384-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The plots look very similar. Therefore, the vectors are probably independent. We could have known this without drawing any graphs. Anything is independent of a constant random variable (vector).</p></li>
<li><div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutation_test</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>, <span class="fu">atan</span>(y<span class="sc">/</span>x))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-385-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Plots look very similar to each other. Therefore, <code>z</code> and <code>w</code> are probably independent.</p></li>
</ol>
<p><em>Note:</em> The plots in b) and d) reveal that the distribution of the random vector
<span class="math inline">\((X,Y)\)</span> consisting of two independent standard normals is probably rotation
invariant. In b) we are asked to compare the coordinates of the vector obtained
from <span class="math inline">\((X,Y)\)</span> by a rotation at <span class="math inline">\(45\)</span> degrees around the origin. The fact that
independence persisted suggests that components remain independent even after a
(specific) rotation. If you tried rotations by different angles you would get
the same result. The experiment in d) told us that the (squared) distance
<span class="math inline">\(X^2+Y^2\)</span> and angle between <span class="math inline">\((X,Y)\)</span> and the <span class="math inline">\(x\)</span>-are independent. This is also
something that one would expect from a rotationally-invariant distribution.
Indeed, the distribution of the distance to the origin should not depend on the
direction.</p>
<p>It is important to note that none of this proves anything. It is simply
numerical evidence for a given conclusion.</p>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-43" class="exercise"><strong>Problem 2.20  </strong></span>Simulate <span class="math inline">\(n=10000\)</span> draws from the joint distribution given by the following
table:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
3
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
</tbody>
</table>
<p>Display the contingency table of your results, as well as a table
showing the
“errors”, i.e., differences between the theoretical frequencies
(i.e., probabilities given above) and the obtained relative
frequencies in the sample.</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-44" class="solution"><em>Solution</em>. </span>We are using the procedure from Section 2.2 in the notes.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb102-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-3" aria-hidden="true" tabindex="-1"></a>joint_distribution_long <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb102-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb102-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb102-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-6" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb102-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-7" aria-hidden="true" tabindex="-1"></a>probabilities_long <span class="ot">=</span></span>
<span id="cb102-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.0</span>, <span class="fl">0.3</span>,</span>
<span id="cb102-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-9" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>,</span>
<span id="cb102-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-10" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.4</span>)</span>
<span id="cb102-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-12" aria-hidden="true" tabindex="-1"></a>sampled_rows <span class="ot">=</span> <span class="fu">sample</span>(</span>
<span id="cb102-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-13" aria-hidden="true" tabindex="-1"></a>   <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(joint_distribution_long),</span>
<span id="cb102-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">size =</span> nsim,</span>
<span id="cb102-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-15" aria-hidden="true" tabindex="-1"></a>   <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb102-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-16" aria-hidden="true" tabindex="-1"></a>   <span class="at">prob =</span> probabilities_long</span>
<span id="cb102-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-18"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-19"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-19" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">=</span> joint_distribution_long[sampled_rows,]</span>
<span id="cb102-20"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-21"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-21" aria-hidden="true" tabindex="-1"></a>(<span class="at">rel_freq =</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(draws)))</span>
<span id="cb102-22"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-22" aria-hidden="true" tabindex="-1"></a><span class="do">##    y</span></span>
<span id="cb102-23"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="do">## x        1      2      3</span></span>
<span id="cb102-24"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   1 0.0998 0.0000 0.3017</span></span>
<span id="cb102-25"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   2 0.0993 0.1005 0.0000</span></span>
<span id="cb102-26"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   3 0.0000 0.0000 0.3987</span></span>
<span id="cb102-27"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-27" aria-hidden="true" tabindex="-1"></a>(<span class="at">th_freq =</span> <span class="fu">matrix</span>(probabilities_long, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb102-28"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-28" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3]</span></span>
<span id="cb102-29"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]  0.1  0.0  0.3</span></span>
<span id="cb102-30"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-30" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]  0.1  0.1  0.0</span></span>
<span id="cb102-31"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-31" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]  0.0  0.0  0.4</span></span>
<span id="cb102-32"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-32" aria-hidden="true" tabindex="-1"></a>(<span class="at">err =</span> rel_freq <span class="sc">-</span> th_freq)</span>
<span id="cb102-33"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-33" aria-hidden="true" tabindex="-1"></a><span class="do">##    y</span></span>
<span id="cb102-34"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-34" aria-hidden="true" tabindex="-1"></a><span class="do">## x         1       2       3</span></span>
<span id="cb102-35"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-35" aria-hidden="true" tabindex="-1"></a><span class="do">##   1 -0.0002  0.0000  0.0017</span></span>
<span id="cb102-36"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-36" aria-hidden="true" tabindex="-1"></a><span class="do">##   2 -0.0007  0.0005  0.0000</span></span>
<span id="cb102-37"><a href="simulation-of-random-variables-and-monte-carlo.html#cb102-37" aria-hidden="true" tabindex="-1"></a><span class="do">##   3  0.0000  0.0000 -0.0013</span></span></code></pre></div>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-45" class="exercise"><strong>Problem 2.21  </strong></span>Estimate the following integrals using Monte Carlo</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(\int_0^1 \cos(x)\, dx\)</span></p></li>
<li><p><span class="math inline">\(\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\frac{e^{-x^2/2}}{1+x^4}\,dx\)</span></p></li>
<li><p><span class="math inline">\(\int_0^{\infty} e^{-x^3-x}\, dx\)</span></p></li>
<li><p><span class="math inline">\(\int_{-\infty}^{\infty} \frac{\cos(x^2)}{1+x^2}\, dx\)</span> (extra credit)</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-46" class="solution"><em>Solution</em>. </span>The idea here is to use the “fundamental theorem of statistics”
<span class="math display">\[ {\mathbb{E}}[ g(X) ] = \int g(x)\, f_X(x)\, dx \]</span>
where <span class="math inline">\(f_X\)</span> is the pdf of <span class="math inline">\(X\)</span> and <span class="math inline">\(g\)</span> is any reasonably well-behaved function.
Normally, one would use the integral on the right to compute the expectation
on the left. We are flipping the logic, and using the expectation
(which we can approximate via Monte Carlo) to estimate the integral on the
right.</p>
<ol style="list-style-type: lower-alpha">
<li><p>We pick <span class="math inline">\(g(x) = \cos(x)\)</span> and <span class="math inline">\(X\)</span> a r.v. with a uniform distribution on <span class="math inline">\((0,1)\)</span>, so that <span class="math inline">\(f_X(x) = 1\)</span> for <span class="math inline">\(x\in (0,1)\)</span> and <span class="math inline">\(0\)</span> otherwise:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb103-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb103-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb103-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb103-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb103-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">cos</span>(x)</span>
<span id="cb103-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb103-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8426696</span></span></code></pre></div>
<p>For comparison, the exact value of the integral is <span class="math inline">\(\sin(1) \approx 0.841471\)</span>.</p></li>
<li><p>We cannot use the uniform distribution anymore, because the limits of integration are <span class="math inline">\(\pm \infty\)</span>. Part of the expression inside the integral can be recognized as a (standard) normal density, so we take <span class="math inline">\(X \sim N(0,1)\)</span> and <span class="math inline">\(g(x) =  1/(1+x^4)\)</span></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb104-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb104-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb104-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(nsim)</span>
<span id="cb104-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb104-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb104-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb104-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.6786274</span></span></code></pre></div>
<p>The “exact” value (i.e., very precise approximation to this integral obtained using another numerical method) is <span class="math inline">\(0.676763\)</span>.</p></li>
<li><p>We integrate <span class="math inline">\(g(x) = \exp(-x^3)\)</span> against the exponential pdf <span class="math inline">\(f_X(x) = \exp(-x)\)</span>, for <span class="math inline">\(x&gt;0\)</span>:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb105-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb105-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb105-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(nsim)</span>
<span id="cb105-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb105-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb105-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb105-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.5680925</span></span></code></pre></div>
<p>A close approximation of the true value is <span class="math inline">\(0.56889\)</span>.</p></li>
<li><p>In this case, a possible choice of the distribution for <span class="math inline">\(X\)</span> is the Cauchy distribution (no worries if you never heard about it), whose pdf is <span class="math inline">\(f_X(x) = \frac{1}{\pi(1+x^2)}\)</span>, so that <span class="math inline">\(g(x) = \pi \cos(x^2)\)</span>:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb106-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb106-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb106-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rcauchy</span>(nsim)</span>
<span id="cb106-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb106-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> pi <span class="sc">*</span> <span class="fu">cos</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb106-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb106-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.320216</span></span></code></pre></div>
<p>The “exact” value is <span class="math inline">\(1.30561\)</span>.</p></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-47" class="exercise"><strong>Problem 2.22  </strong></span>The <strong>tricylinder</strong> is a solid body constructed as follows: create three
cylinders of radius 1 around each of the three coordinate axes and intersect
them:</p>
<figure style="
    display: flex;
    flex-flow: column;
    padding: 5px;
    margin: auto;">
<img src="pics/tricylinder.png" style="border-bottom: -10px;"></img>
<figcaption style=" 
    background-color: #fff;
    color: #000;
    font: italic smaller sans-serif;
    padding: 3px;
    text-align: center;">
Image by Ag2gaeh - Own work, CC BY-SA 4.0, <a href="https://commons.wikimedia.org/w/index.php?curid=63604565" class="uri">https://commons.wikimedia.org/w/index.php?curid=63604565</a>
</figcaption>
</figure>
<p>Use Monte Carlo to estimate the volume of the tricylinder and
check your estimate against the exact value <span class="math inline">\(8(2-\sqrt{2})\)</span>.</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-48" class="solution"><em>Solution</em>. </span>By the very construction, it is clear that the entire tricylinder lies
within the cube <span class="math inline">\([-1,1]\times [-1,1] \times[-1,1]\)</span>. Therefore, we can
compute its volume by simulating random draws from the uniform
distribution in that cube, and computing the relative frequence of
those values that fall inside the tricylinder. The whole point is
that it is easy to check, given a point <span class="math inline">\((x,y,z)\)</span>, whether it lies
inside the tricylinder or not. Indeed, the answer is “yes” if and
only if all three of the following inequalities are satisfied: <span class="math display">\[
x^2+y^2 \le 1,\  x^2+z^2\leq 1 \text{ and } y^2+z^2\leq 1.\]</span></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb107-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(nsim, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb107-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">runif</span>(nsim, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb107-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">runif</span>(nsim, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb107-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-5" aria-hidden="true" tabindex="-1"></a>is_in <span class="ot">=</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">&amp;</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> z<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">&amp;</span> (y<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> z<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb107-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-7" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span><span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> <span class="fu">sum</span>(is_in)<span class="sc">/</span>nsim)</span>
<span id="cb107-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.708</span></span></code></pre></div>
<p>We multiplied by <span class="math inline">\(2^3\)</span> because that is the volume of the cube
<span class="math inline">\([-1,1]\times [-1,1] \times [-1,1]\)</span>. Without it, we would get the
portion of the cube taken by the tricylinder, and not its volume.</p>
<p>The true value of <span class="math inline">\(8(2-\sqrt{2})\)</span> is, approximately, <span class="math inline">\(4.6862\)</span>.</p>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-49" class="exercise"><strong>Problem 2.23  (Extra Credit) </strong></span>Read about the <strong>Monty Hall Problem</strong> online (the introduction to its
<a href="https://en.wikipedia.org/wiki/Monty_Hall_problem">Wikipedia page</a> has a nice description),
Use Monte Carlo to compare the two possible strategies (switching and
not-switching) and decide which is better.</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-50" class="solution"><em>Solution</em>. </span>The host knows where the car is and what contestant’s guess is. If those two are the same (i.e., contestant guessed right), he will choose one of the two remaining doors at random. If not, he simply shows the contestant the other door with the goat behind it. This exactly what the function <code>show_door</code> implements:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-1" aria-hidden="true" tabindex="-1"></a>show_door <span class="ot">=</span> <span class="cf">function</span>(car, guess) {</span>
<span id="cb108-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-2" aria-hidden="true" tabindex="-1"></a>    all_doors <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb108-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-3" aria-hidden="true" tabindex="-1"></a>    goat_doors <span class="ot">=</span> all_doors[all_doors <span class="sc">!=</span> car]</span>
<span id="cb108-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (car <span class="sc">==</span> guess) {</span>
<span id="cb108-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-6" aria-hidden="true" tabindex="-1"></a>        random_goat_door <span class="ot">=</span> <span class="fu">sample</span>(goat_doors, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb108-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(random_goat_door)</span>
<span id="cb108-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-8" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb108-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-9" aria-hidden="true" tabindex="-1"></a>        the_other_goat_door <span class="ot">=</span> goat_doors[goat_doors <span class="sc">!=</span> guess]</span>
<span id="cb108-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(the_other_goat_door)</span>
<span id="cb108-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb108-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb108-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, we write a function which simulates the outcome of a single game. It will have one argument, <code>switch</code> which will determine whether the contestant switches the door or not.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-1" aria-hidden="true" tabindex="-1"></a>one_game <span class="ot">=</span> <span class="cf">function</span>(<span class="cf">switch</span>) {</span>
<span id="cb109-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-2" aria-hidden="true" tabindex="-1"></a>    all_doors <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb109-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-3" aria-hidden="true" tabindex="-1"></a>    car <span class="ot">=</span> <span class="fu">sample</span>(all_doors, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb109-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-4" aria-hidden="true" tabindex="-1"></a>    guess <span class="ot">=</span> <span class="fu">sample</span>(all_doors, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb109-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="cf">switch</span>) {</span>
<span id="cb109-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-7" aria-hidden="true" tabindex="-1"></a>        unguessed_doors <span class="ot">=</span> all_doors[all_doors <span class="sc">!=</span> guess]</span>
<span id="cb109-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-8" aria-hidden="true" tabindex="-1"></a>        shown_door <span class="ot">=</span> <span class="fu">show_door</span>(car, guess)</span>
<span id="cb109-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-9" aria-hidden="true" tabindex="-1"></a>        switched_guess <span class="ot">=</span> unguessed_doors[unguessed_doors <span class="sc">!=</span> shown_door]</span>
<span id="cb109-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(switched_guess <span class="sc">==</span> car)</span>
<span id="cb109-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb109-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(guess <span class="sc">==</span> car)</span>
<span id="cb109-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb109-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb109-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Finally we run two batches of <span class="math inline">\(10,000\)</span> simulations, one with <code>switch=TRUE</code> and another with <code>switch=FALSE</code>:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb110-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb110-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb110-2" aria-hidden="true" tabindex="-1"></a>switch_doors <span class="ot">=</span> <span class="fu">replicate</span>(nsim, <span class="fu">one_game</span>(<span class="cn">TRUE</span>))</span>
<span id="cb110-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb110-3" aria-hidden="true" tabindex="-1"></a>dont_switch_doors <span class="ot">=</span> <span class="fu">replicate</span>(nsim, <span class="fu">one_game</span>(<span class="cn">FALSE</span>))</span>
<span id="cb110-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb110-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">prob_with_switching =</span> <span class="fu">mean</span>(switch_doors))</span>
<span id="cb110-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.668</span></span>
<span id="cb110-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb110-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">prob_without_switching =</span> <span class="fu">mean</span>(dont_switch_doors))</span>
<span id="cb110-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3288</span></span></code></pre></div>
<p>Therefore, the probability of winning after switching is about double the probability of winning without switching. Switching is good for you!</p>
<p>(A philosophical note: this was the most “agnostic” approach to this simulation. Simulations can often be simplified with a bit of insight. For example, we could have realized that the switching strategy simply flips the correctness of the guess (from “correct” to “wrong” and vice versa) and used it to write a much shorter answer. Ultimately, we could have realized that, because the probability of the initial guess being correct is <span class="math inline">\(1/3\)</span>, switching leads to a correct guess in <span class="math inline">\(2/3\)</span> of the cases (and not switching in only <span class="math inline">\(1/3\)</span> of the cases). In this case, the whole code would be <code>sample(c("correct", "incorrect"), size=10000, prob= c(2/3,1/3), replacement=TRUE)</code>, which is an extremely inefficient way to estimate the value of the number <span class="math inline">\(2/3\)</span>!)</p>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-51" class="exercise"><strong>Problem 2.24  </strong></span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>Find the beta distribution in R’s help system. The only
thing you need to know about it is that it comes with two positive
parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> (called <code>shape1</code> and <code>shape2</code> in R).
Simulate <span class="math inline">\(n=10000\)</span> draws from the beta distribution with parameters
<span class="math inline">\(\alpha=0.5\)</span> and <span class="math inline">\(\beta=0.3\)</span>. Plot a density histogram of your
simulations as well as the pdf of the underlying distribution on the
same plot. (Note: if you use the command <code>lines</code> instead of <code>plot</code>
for the pdf, it will be automatically added to your previous plot -
the histogram, in this case).</p></li>
<li><p>Let <span class="math inline">\(X\)</span> be a beta-distributed random variable with parameters
<span class="math inline">\(\alpha=0.5\)</span> and <span class="math inline">\(\beta=0.3\)</span> (as above), and let <span class="math inline">\(Y\)</span> be an
independent random variable with the same distribution. Estimate the
probability <span class="math inline">\({\mathbb{P}}[ XY &gt; 1+ \log(Y)]\)</span>. Check graphically whether <span class="math inline">\(XY\)</span>
and <span class="math inline">\(1+\log(Y)\)</span> are independent random variables.</p></li>
<li><p>Let <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span> be three independent random variables
uniformly distributed on <span class="math inline">\((0,1)\)</span>, and let <span class="math inline">\(M = \min(X,Y,Z)\)</span>. A
theorem in probability states that <span class="math inline">\(M\)</span> has a beta distribution with
some parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Use simulation (and associated
plots) to make an educated guess about what the values of <span class="math inline">\(\alpha\)</span>
and <span class="math inline">\(\beta\)</span> are. (Hint: they are nice round numbers.)</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-52" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li><div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb111-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">10000</span>, <span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.3</span>)</span>
<span id="cb111-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> T)</span>
<span id="cb111-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb111-3" aria-hidden="true" tabindex="-1"></a>x_pdf <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb111-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb111-4" aria-hidden="true" tabindex="-1"></a>y_pdf <span class="ot">=</span> <span class="fu">dbeta</span>(x_pdf, <span class="fl">0.5</span>, <span class="fl">0.3</span>)</span>
<span id="cb111-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_pdf, y_pdf, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-431-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>We use Monte Carlo to estimate the probability:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb112-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">10000</span>, <span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.3</span>)</span>
<span id="cb112-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb112-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">10000</span>, <span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.3</span>)</span>
<span id="cb112-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb112-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> x <span class="sc">*</span> y <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(y)</span>
<span id="cb112-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)</span>
<span id="cb112-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.4457</span></span></code></pre></div>
<p>and the permuation test to check for (in)dependence</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">=</span> x <span class="sc">*</span> y</span>
<span id="cb113-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(y)</span>
<span id="cb113-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb113-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-4" aria-hidden="true" tabindex="-1"></a>z_perm_1 <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb113-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-5" aria-hidden="true" tabindex="-1"></a>z_perm_2 <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb113-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-6" aria-hidden="true" tabindex="-1"></a>z_perm_3 <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb113-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w, z)</span>
<span id="cb113-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w, z_perm_1)</span>
<span id="cb113-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w, z_perm_2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-433-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Since the first plot looks very different from the other three, we conclude that <span class="math inline">\(XY\)</span> and <span class="math inline">\(1+\log(Y)\)</span> are most likely not independent.</p></li>
<li><p>First, we simulate <span class="math inline">\(10,000\)</span> draws from the distribution of <span class="math inline">\(M\)</span>. The function <code>min</code> is not vectorized (and it should not be!), so we cannot simply write <span class="math inline">\(m = min(x,y,z)\)</span>. Luckily there is another function, called <code>pmin</code> (where <code>p</code> stands for parallel) which returns the component-wise min. Alternatively, we could use the function <code>apply</code> to apply <code>min</code> to each row of the data frame <code>df</code> which contains the simulations of <span class="math inline">\(X,Y\)</span> and <span class="math inline">\(Z\)</span>:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb114-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb114-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb114-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb114-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">pmin</span>(x, y, z)</span>
<span id="cb114-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># or, alternatively,</span></span>
<span id="cb114-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(x, y, z)</span>
<span id="cb114-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb114-8" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, min)</span></code></pre></div>
<p>The idea is to compare the histogram of (the simulations) of <span class="math inline">\(M\)</span> to pdfs of the beta distributions for
various values of parameters and see what fits best. The function <code>try_parameters</code> below does exacly that - it superimposes the beta pdf onto the histogram of <code>m</code> (just like in part 1. above). We try a few different values, and finally settle on <span class="math inline">\(\alpha=1\)</span> and <span class="math inline">\(\beta=3\)</span>, because it seems to fit will. It turns out that <span class="math inline">\(\alpha=1\)</span> and <span class="math inline">\(\beta=3\)</span> is, indeed, correct.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-1" aria-hidden="true" tabindex="-1"></a>try_parameters <span class="ot">=</span> <span class="cf">function</span>(alpha, beta) {</span>
<span id="cb115-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(m, <span class="at">probability =</span> T, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Trying alpha = &quot;</span>, alpha, <span class="st">&quot; beta = &quot;</span>, beta))</span>
<span id="cb115-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-3" aria-hidden="true" tabindex="-1"></a>    x_pdf <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb115-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-4" aria-hidden="true" tabindex="-1"></a>    y_pdf <span class="ot">=</span> <span class="fu">dbeta</span>(x_pdf, alpha, beta)</span>
<span id="cb115-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(x_pdf, y_pdf, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb115-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb115-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb115-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb115-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb115-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="fl">0.5</span>, <span class="dv">2</span>)</span>
<span id="cb115-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="fl">0.5</span>, <span class="dv">3</span>)</span>
<span id="cb115-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-435-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Alternatively, you could have looked up the mean and the variance of the beta distribution online, and obtained the following expressions:
<span class="math display">\[ \text{ mean}= \frac{\alpha}{\alpha+\beta}, \text{ variance} = \frac{\alpha\beta}{(\alpha+\beta)^2 (\alpha+\beta+1)},\]</span>
and then tried to find <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> to match the estimated mean and variance</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(m), <span class="fu">var</span>(m))</span>
<span id="cb116-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.24952292 0.03719576</span></span></code></pre></div>
<p>The first equation tells us that <span class="math inline">\(\alpha/(\alpha+\beta)\)</span> is about <span class="math inline">\(1/4\)</span>, i.e., <span class="math inline">\(3 \alpha \approx \beta\)</span>. We plug the obtained value of <span class="math inline">\(\beta\)</span> into the equation for variance to get the following equation:
<span class="math display">\[ 0.0372 \approx \frac{ 3 \alpha^2}{ (4\alpha)^2 (4 \alpha+1)^2},\]</span>
so that
<span class="math display">\[ 4 \alpha + 1 \approx \frac{3}{ 16\times 0.0372} \approx 5.04, \text{ i.e., } \alpha \approx 1 \text{ and } \beta \approx 3.\]</span>
This estimation technique - where the mean and variance (and possibly higher moments) are computed and matched to parameters - is called the <strong>method of moments</strong>.</p>
<p>In case you are curious, here is how to derive the theorem from the problem (and check that our guess is, indeed, correct). We note that for any <span class="math inline">\(x\in (0,1)\)</span>, <span class="math inline">\(M&gt; x\)</span> if and only if <span class="math inline">\(X&gt;x\)</span>, <span class="math inline">\(Y&gt;x\)</span> and <span class="math inline">\(Z&gt;x\)</span>. Therefore, by independence of <span class="math inline">\(X,Y\)</span> and <span class="math inline">\(Z\)</span>, we have
<span class="math display">\[ {\mathbb{P}}[ M &gt; x ] = {\mathbb{P}}[ X&gt;x, Y&gt;x, Z&gt;x] = {\mathbb{P}}[X&gt;x] \times {\mathbb{P}}[Y&gt;x] \times  {\mathbb{P}}[Z&gt;x] = (1-x)^3.\]</span>
From there, we conclude that the cdf of <span class="math inline">\(M\)</span> is given by
<span class="math display">\[F(x) = {\mathbb{P}}[M\leq x] = 1- {\mathbb{P}}[M&gt;x] = 1 - (1-x)^3.\]</span>
Since F is a smooth function, we can differentiate it to get the pdf:
<span class="math display">\[ f(x) = F&#39;(x) = 3 (1-x)^2,\]</span>
which is exactly the pdf of the beta distribution with parameters <span class="math inline">\(3\)</span> and <span class="math inline">\(1\)</span> (see the <a href="https://en.wikipedia.org/wiki/Beta_distribution">Wikipedia page</a> of the beta distribution for this and many other facts).</p></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-53" class="exercise"><strong>Problem 2.25  </strong></span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>Find the gamma distribution in R’s help system. The only
thing you need to know about it is that it comes with two positive
parameters <span class="math inline">\(k\)</span> and <span class="math inline">\(\theta\)</span> (called <code>shape</code> and <code>scale</code> in R).
Simulate <span class="math inline">\(n=10000\)</span> draws from the gamma distribution with parameters
<span class="math inline">\(k=2\)</span> and <span class="math inline">\(\theta=1\)</span>. Plot a density histogram of your
simulations as well as the pdf of the underlying distribution on the
same plot. Repeat for <span class="math inline">\(3\)</span> more choices (left to you) of the parameters <span class="math inline">\(k\)</span> and <span class="math inline">\(\theta\)</span>.</p></li>
<li><p>Let <span class="math inline">\(X\)</span> be a gamma-distributed random variable with parameters
<span class="math inline">\(k=2\)</span> and <span class="math inline">\(\theta=1\)</span> (as above), and let <span class="math inline">\(Y_1, Y_2\)</span> be a independent standard
normals (also independent of <span class="math inline">\(X\)</span>). Estimate the
probability <span class="math inline">\({\mathbb P}[ X &gt; Y_1^2 + Y_2^2 ]\)</span> using Monte Carlo.
Check graphically whether <span class="math inline">\(XY_1\)</span> and
<span class="math inline">\(X Y_2\)</span> are independent.</p></li>
<li><p>Let <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> and <span class="math inline">\(Z\)</span> be three independent random variables
with the gamma distribution and the scale parameter <span class="math inline">\(\theta=1\)</span>. Their shape parameters are, however different, and equal to <span class="math inline">\(1,2\)</span> and <span class="math inline">\(3\)</span>, respectively.
Use simulation (and associated plots) to make an educated guess about the distribution of
<span class="math inline">\(X+Y+Z\)</span> and its parameters. (Hint: the parameters will be nice round numbers.)</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-54" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li><div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-1" aria-hidden="true" tabindex="-1"></a>hist_with_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(k, theta) {</span>
<span id="cb117-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>, <span class="at">shape =</span> k, <span class="at">scale =</span> theta)</span>
<span id="cb117-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x, </span>
<span id="cb117-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">probability =</span> T,  </span>
<span id="cb117-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">breaks =</span> <span class="dv">50</span>, </span>
<span id="cb117-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>),</span>
<span id="cb117-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;shape = &quot;</span>, k, <span class="st">&quot;, scale = &quot;</span>, theta)</span>
<span id="cb117-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb117-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-9" aria-hidden="true" tabindex="-1"></a>  x_pdf <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb117-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-10" aria-hidden="true" tabindex="-1"></a>  y_pdf <span class="ot">=</span> <span class="fu">dgamma</span>(x_pdf, <span class="at">shape =</span> k, <span class="at">scale =</span> theta)</span>
<span id="cb117-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x_pdf, y_pdf,</span>
<span id="cb117-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb117-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb117-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb117-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  </span>
<span id="cb117-18"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="fu">hist_with_pdf</span>(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb117-19"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist_with_pdf</span>(<span class="dv">2</span>,<span class="fl">0.5</span>)</span>
<span id="cb117-20"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="fu">hist_with_pdf</span>(<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb117-21"><a href="simulation-of-random-variables-and-monte-carlo.html#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="fu">hist_with_pdf</span>(<span class="dv">3</span>,<span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-447-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>We use Monte Carlo to estimate the probability:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb118-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb118-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb118-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb118-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb118-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb118-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb118-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> x <span class="sc">&gt;</span> y1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb118-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)</span>
<span id="cb118-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.5508</span></span></code></pre></div>
<p>and the permuation test to check for (in)dependence</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">=</span> x <span class="sc">*</span> y1</span>
<span id="cb119-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> x <span class="sc">*</span> y2</span>
<span id="cb119-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb119-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-4" aria-hidden="true" tabindex="-1"></a>z_perm_1 <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb119-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-5" aria-hidden="true" tabindex="-1"></a>z_perm_2 <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb119-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-6" aria-hidden="true" tabindex="-1"></a>z_perm_3 <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb119-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w, z)</span>
<span id="cb119-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w, z_perm_1)</span>
<span id="cb119-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w, z_perm_2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-449-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The common shape of plots 2, 3. and 4. is sufficiently different from the shape
of plot 1. to conclude that <span class="math inline">\(XY_1\)</span> and <span class="math inline">\(XY_2\)</span> are most likely not independent.
Note: if you were to compute the correlation between <span class="math inline">\(XY_1\)</span> and <span class="math inline">\(XY_2\)</span> you would
get <span class="math inline">\(0\)</span> - this is an example of uncorrelated random variables that are,
nevertheless, not independent.</p></li>
<li><p>First, we simulate <span class="math inline">\(10,000\)</span> draws from the distribution of <span class="math inline">\(S = X + Y + Z\)</span> and plot
the histogram of obtained values:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb120-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb120-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb120-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rgamma</span>(nsim, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb120-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb120-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rgamma</span>(nsim, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb120-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb120-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">rgamma</span>(nsim, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb120-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb120-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> x <span class="sc">+</span> y <span class="sc">+</span> z</span>
<span id="cb120-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(s, <span class="at">breaks =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-450-1.png" width="672" style="display: block; margin: auto;" />
The shape resembles the shape we obtained in 1. above, so we try the gamma distribution with various parameters.
The function <code>try_parameters</code> below does exacly that - it superimposes the gamma pdf onto the histogram of <code>s</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-1" aria-hidden="true" tabindex="-1"></a>try_parameters <span class="ot">=</span> <span class="cf">function</span>(k, theta) {</span>
<span id="cb121-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(s, <span class="at">probability =</span> T, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Trying shape = &quot;</span>, k, <span class="st">&quot; scale = &quot;</span>,</span>
<span id="cb121-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-3" aria-hidden="true" tabindex="-1"></a>        theta))</span>
<span id="cb121-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-4" aria-hidden="true" tabindex="-1"></a>    x_pdf <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb121-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-5" aria-hidden="true" tabindex="-1"></a>    y_pdf <span class="ot">=</span> <span class="fu">dgamma</span>(x_pdf, k, theta)</span>
<span id="cb121-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(x_pdf, y_pdf, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb121-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb121-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb121-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb121-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb121-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb121-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb121-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="fu">try_parameters</span>(<span class="dv">4</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-451-1.png" width="672" style="display: block; margin: auto;" />
We conclude that <span class="math inline">\(X+Y+Z\)</span> is most likely gamma-distributed with <span class="math inline">\(k=6\)</span> and
<span class="math inline">\(\theta=1\)</span>. This is indeed, the case. The sum of independen gammas with shape
parameters <span class="math inline">\(k_1, \dots, k_n\)</span> and the same scale parameter <span class="math inline">\(\theta\)</span> is a gamma
with parameters <span class="math inline">\(k = k_1+\dots+k_n\)</span> and <span class="math inline">\(\theta\)</span>.</p></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-55" class="exercise"><strong>Problem 2.26  </strong></span>We learned how to simulate from a joint distribution of two discrete vectors
<span class="math inline">\((X,Y\)</span>) by thinking of it as one-dimensional distribution but with values
represented by pairs of numbers. Here is another way this can be done:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the marginal distribution of one of them, say <span class="math inline">\(X\)</span>, and simulate from it</p></li>
<li><p>Given the value you just obtained, let’s <!--'--> call it <span class="math inline">\(x\)</span>, simulate from the conditional distribution of <span class="math inline">\(Y\)</span>, given <span class="math inline">\(X=x\)</span>.</p></li>
</ol>
Implement this procedure on the following joint distribution:
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
3
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
</tbody>
</table>
<p>Display the contingency table of your simulations, first using counts, and then
using relative frequencies. Compare to the theoretical values (i.e., the
probabilities in the table above).</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-56" class="solution"><em>Solution</em>. </span><br />
</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-1" aria-hidden="true" tabindex="-1"></a>margin_X <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span> )</span>
<span id="cb122-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-2" aria-hidden="true" tabindex="-1"></a>cond_Y_X <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb122-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>( <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">7</span>,</span>
<span id="cb122-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.0</span>,</span>
<span id="cb122-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-5" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="dv">4</span><span class="sc">/</span><span class="dv">7</span>),</span>
<span id="cb122-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb122-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb122-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-9" aria-hidden="true" tabindex="-1"></a>single_draw <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb122-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-10" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span>margin_X)</span>
<span id="cb122-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-11" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span>cond_Y_X[,x])</span>
<span id="cb122-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">c</span>(x,y))</span>
<span id="cb122-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-15" aria-hidden="true" tabindex="-1"></a>nsim<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb122-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb122-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">t</span>(<span class="fu">replicate</span>(nsim, <span class="fu">single_draw</span>()))</span>
<span id="cb122-18"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-19"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)</span>
<span id="cb122-20"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-20" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">table</span>(df))</span>
<span id="cb122-21"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-21" aria-hidden="true" tabindex="-1"></a><span class="do">##    x</span></span>
<span id="cb122-22"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-22" aria-hidden="true" tabindex="-1"></a><span class="do">## y      1    2    3</span></span>
<span id="cb122-23"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   1  962    0 2963</span></span>
<span id="cb122-24"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   2 1012 1023    0</span></span>
<span id="cb122-25"><a href="simulation-of-random-variables-and-monte-carlo.html#cb122-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   3    0    0 4040</span></span></code></pre></div>
<p>The variables <code>margin_X</code> and <code>cond_X_Y</code> are what you get when you compute the marginal and the conditional distribution from the given joint-distribution table as you did in your probability class.</p>
<p>The function <code>single_draw</code> performs a single draw form the distribution of <span class="math inline">\((X,Y)\)</span> by first drawing the value of <span class="math inline">\(X\)</span> from its marginal distribution. Then, it chooses the row of the conditional distribution table according to the obtained value of <span class="math inline">\(X\)</span> and simulates from it.</p>
<p>The function <code>replicate</code> is used to repeat <code>single_draw</code> many times and collect the results. By default, <code>replicate</code> attaches the output of each new “replication” as a new column and not a row, so we need to transpose the final product. That is what the function <code>t()</code> is for. We turn the result into a data frame because the function <code>table</code> knows how to handle data frames automatically. Another use of the transpose gives <code>x</code> the horizontal axis, and <code>y</code> the vertical one, like in the statement of the problem.</p>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-57" class="exercise"><strong>Problem 2.27  </strong></span>Let <span class="math inline">\((Z,W)\)</span> is be a discrete random vector with the following joint distribution table (different rows correspond to different values of <span class="math inline">\(Z\)</span>):</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
-1
</th>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
-1
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
</tbody>
</table>
<p>and set <span class="math display">\[ X = Z+W \text{ and } Y=Z W.\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Find the distribution table for <span class="math inline">\((X,Y)\)</span> and compute <span class="math inline">\({\mathbb{E}}[ X Y]\)</span> and <span class="math inline">\({\mathbb{P}}[X=0 | Y=0]\)</span> analytically (no simulations!).
You can do this part on a separate piece of paper or inside your Rmd file if you know LaTeX.</p></li>
<li><p>Draw <span class="math inline">\(10000\)</span> simulations of <span class="math inline">\((X,Y)\)</span> (don’t print them out). Display the
contingency table of your simulations using relative frequencies, as well as the
table of errors (differences between your contingency table and the table of
probabilities).</p></li>
<li><p>Compute <span class="math inline">\({\mathbb{E}}[X Y]\)</span> again, but this time using your simulations from 1. above.</p></li>
<li><p>Draw simulations from the conditional distribution of <span class="math inline">\(X\)</span>, given <span class="math inline">\(Y=0\)</span>. Use them to estimate the conditional probability <span class="math inline">\({\mathbb{P}}[ X=0 | Y=0]\)</span>.
By how much does it differ from your analytical result from 1. above.</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-58" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li>The entry at <span class="math inline">\((i,j)\)</span> of the distribution table for <span class="math inline">\((X,Y)\)</span> contains, by definition, the
probability <span class="math inline">\({\mathbb{P}}[ X=i \text{ and } Y=i]\)</span>. The possible values for <span class="math inline">\(X = Z+W\)</span> are
<span class="math inline">\(-2,1,0,1,2\)</span> and the possible values for <span class="math inline">\(Y = Z W\)</span> are <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (note that
<span class="math inline">\(Y\)</span> cannot be <span class="math inline">\(-1\)</span>!). To compute, e.g. <span class="math inline">\({\mathbb{P}}[ X=1, Y=0]\)</span> we look for all possible
combinations of the values of <span class="math inline">\(Z,W\)</span> with the property <span class="math inline">\(Z+W = 1\)</span> and <span class="math inline">\(Z W =0\)</span>. It
turns out there are two possibilities, namely <span class="math inline">\(Z = 0, W=1\)</span> and <span class="math inline">\(Z=1, W=0\)</span>.
Each of those comes with probability <span class="math inline">\(0.1\)</span>, which means that <span class="math inline">\({\mathbb{P}}[ X=1, Y=0] = 0.2\)</span>. We fill out the remaining entries in a similar way (rows correspond to values of <span class="math inline">\(X\)</span>):</li>
</ol>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
-2
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
-1
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
0
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
1
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
2
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
</tbody>
</table>
<pre><code>  To compute $\EE[XY]$ we compute the value of the product $i j$ for each entry in
  the table above, multiply it by the probability there and sum the obtained
  results. The only non-zero terms are $1 \times (-2) \times 0.2$ and $1 \times 2
  \times 0.2$, so  $$ \EE[ XY ] = -2 \times 0.2 + 2 \times 0.2 = 0.$$ Finally, $$
  \PP[ X=0 | Y=0] = \frac{\PP[ X=0, Y=0]}{ \PP[ Y=0]} = \frac{ 0.2}{ 0.2 + 0.2 +
  0.2} = \frac{1}{3}.$$</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>We borrow the code from the notes to draw simulations from the distribution of <span class="math inline">\((W,Z)\)</span>, first:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-1" aria-hidden="true" tabindex="-1"></a>joint_distribution_long <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb124-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">z =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb124-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">w =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>) )</span>
<span id="cb124-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-4" aria-hidden="true" tabindex="-1"></a>probabilities_long <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>);</span>
<span id="cb124-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-5" aria-hidden="true" tabindex="-1"></a>sampled_rows <span class="ot">=</span> <span class="fu">sample</span>(</span>
<span id="cb124-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(joint_distribution_long),</span>
<span id="cb124-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">size =</span> <span class="dv">10000</span>,</span>
<span id="cb124-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-8" aria-hidden="true" tabindex="-1"></a>   <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb124-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-9" aria-hidden="true" tabindex="-1"></a>   <span class="at">prob =</span> probabilities_long )</span>
<span id="cb124-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb124-10" aria-hidden="true" tabindex="-1"></a>d_zw <span class="ot">=</span> joint_distribution_long[sampled_rows, ]</span></code></pre></div>
<p>Then we transform the results into <span class="math inline">\((X,Y)\)</span> and output the table of relative frequencies:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-1" aria-hidden="true" tabindex="-1"></a>draws_xy <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> d_zw<span class="sc">$</span>z <span class="sc">+</span> d_zw<span class="sc">$</span>w, <span class="at">y =</span> d_zw<span class="sc">$</span>z <span class="sc">*</span> d_zw<span class="sc">$</span>w)</span>
<span id="cb125-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">cont_table =</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(draws_xy)))</span>
<span id="cb125-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="do">##     y</span></span>
<span id="cb125-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="do">## x         0      1</span></span>
<span id="cb125-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   -2 0.0000 0.2059</span></span>
<span id="cb125-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   -1 0.1993 0.0000</span></span>
<span id="cb125-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   0  0.1987 0.0000</span></span>
<span id="cb125-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   1  0.1940 0.0000</span></span>
<span id="cb125-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   2  0.0000 0.2021</span></span></code></pre></div>
<p>We build a matrix containing the probabilities we derived in 1. above and subtract it from <code>cont_table</code>:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-1" aria-hidden="true" tabindex="-1"></a>prob_table <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb126-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">error_table =</span> cont_table <span class="sc">-</span> prob_table)</span>
<span id="cb126-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="do">##     y</span></span>
<span id="cb126-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="do">## x          0       1</span></span>
<span id="cb126-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   -2  0.0000  0.0059</span></span>
<span id="cb126-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   -1 -0.0007  0.0000</span></span>
<span id="cb126-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   0  -0.0013  0.0000</span></span>
<span id="cb126-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   1  -0.0060  0.0000</span></span>
<span id="cb126-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   2   0.0000  0.0021</span></span></code></pre></div></li>
<li><p>Monte Carlo:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(draws_xy<span class="sc">$</span>x <span class="sc">*</span> draws_xy<span class="sc">$</span>y)</span>
<span id="cb127-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.0076</span></span></code></pre></div></li>
<li><p>First we remove all rows from <code>draws_xy</code> whose <span class="math inline">\(y\)</span>-component is not <span class="math inline">\(0\)</span></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb128-1" aria-hidden="true" tabindex="-1"></a>draws_cond <span class="ot">=</span> draws_xy[draws_xy<span class="sc">$</span>y <span class="sc">==</span> <span class="dv">0</span>, ]</span></code></pre></div>
<p>Then we compute the relative frequency of the remaining draws where <span class="math inline">\(x=0\)</span>:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb129-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">est_prob =</span> <span class="fu">mean</span>(draws_cond<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb129-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3356419</span></span></code></pre></div>
<p>The true value is <span class="math inline">\(1/3\)</span>, so the error is given by</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb130-1" aria-hidden="true" tabindex="-1"></a>est_prob <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb130-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.002308559</span></span></code></pre></div></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-59" class="exercise"><strong>Problem 2.28  </strong></span>Harry Potter’s cousin Nigel Potter owns a magical set of three dice. They behave just like any three (fair, independent) 6-sided dice, except for the fact that, when thrown together, they always show three <em>distinct</em> numbers. In other words, the outcomes with repeating numbers never happen, while all combinations of three distinct numbers are equally likely.</p>
<ol style="list-style-type: decimal">
<li><p>Create a large (<span class="math inline">\(\ge 10,000\)</span>) set of simulations of throws of these magical dice. Use any method you like.</p></li>
<li><p>Output the contingency table for the outcomes of the first two dice, and compare to theoretical probabilities.</p></li>
<li><p>Draw samples from the conditional distribution of the outcome of the third die, given that the sum on the first two is <span class="math inline">\(6\)</span>. Display the contingency table for your outcomes.</p></li>
<li><p>(Extra credit) Find the (theoretical) conditional distribution of the third die given that the sum on the first two is <span class="math inline">\(6\)</span>, and compare it to your result from 3. above.</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-60" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>Here are three different methods you can use to do this problem:</p>
<p><em>Sampling without replacement:</em></p>
<p>The three magical dice sample <em>without</em> replacement from the set <span class="math inline">\(\{1,2,3,4,5,6\}\)</span>, so we can simply do the following:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb131-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb131-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb131-2" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">replicate</span>(nsim, <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>))))</span>
<span id="cb131-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sims) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)</span></code></pre></div>
<p><em>The rejection method:</em></p>
<p>We simulate three regular dice, and then simply reject all outcomes where two of the numbers are the same:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">25000</span></span>
<span id="cb132-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">size =</span> nsim, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-3" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">size =</span> nsim, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-4" aria-hidden="true" tabindex="-1"></a>z0 <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">size =</span> nsim, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-6" aria-hidden="true" tabindex="-1"></a>good <span class="ot">=</span> (x0 <span class="sc">!=</span> y0) <span class="sc">&amp;</span> (y0 <span class="sc">!=</span> z0) <span class="sc">&amp;</span> (x0 <span class="sc">!=</span> z0)</span>
<span id="cb132-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-8" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x0[good], <span class="at">y =</span> y0[good], <span class="at">z =</span> z0[good])</span>
<span id="cb132-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb132-9" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="fu">dim</span>(sims)[<span class="dv">1</span>]  <span class="co"># we rejected a random number of draws</span></span></code></pre></div>
<p><em>Using <code>sample</code>:</em></p>
<p>We need to make the list of all allowed combinations (no repeats) and then sample the
entire triplet of dice at once. I am using <code>rbind</code> to append a row to a data frame, but you can do this in many other ways.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb133-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb133-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb133-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb133-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb133-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ((i <span class="sc">!=</span> j) <span class="sc">&amp;</span> (j <span class="sc">!=</span> k) <span class="sc">&amp;</span> (i <span class="sc">!=</span> k)) {</span>
<span id="cb133-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-7" aria-hidden="true" tabindex="-1"></a>                df <span class="ot">=</span> <span class="fu">rbind</span>(df, <span class="fu">c</span>(i, j, k))</span>
<span id="cb133-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-8" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb133-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb133-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb133-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)</span>
<span id="cb133-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-14" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">row.names</span>(df))  <span class="co"># as.numeric needed to turn strings into integers</span></span>
<span id="cb133-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-15" aria-hidden="true" tabindex="-1"></a>sampled_rows <span class="ot">=</span> <span class="fu">sample</span>(rows, nsim, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb133-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb133-17" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">=</span> df[sampled_rows, ]</span></code></pre></div></li>
<li><p>The probability of seeing a pair <span class="math inline">\((i,j)\)</span> is <span class="math inline">\(0\)</span> if <span class="math inline">\(i=j\)</span> and <span class="math inline">\(1/30\)</span> otherwise (where <span class="math inline">\(30\)</span> is the number of pairs of different numbers).</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-1" aria-hidden="true" tabindex="-1"></a>table_sim <span class="ot">=</span> <span class="fu">table</span>(sims<span class="sc">$</span>x, sims<span class="sc">$</span>y)<span class="sc">/</span>nsim</span>
<span id="cb134-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-2" aria-hidden="true" tabindex="-1"></a>table_th <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">30</span>, <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">6</span>)</span>
<span id="cb134-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) table_th[i, i] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb134-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">error =</span> table_sim <span class="sc">-</span> table_th)</span>
<span id="cb134-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    </span></span>
<span id="cb134-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="do">##             1         2         3         4         5         6</span></span>
<span id="cb134-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   1  0.000000  0.000267  0.000177  0.000047 -0.000653  0.001067</span></span>
<span id="cb134-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   2 -0.000073  0.000000 -0.000623  0.000927 -0.000743  0.000207</span></span>
<span id="cb134-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   3 -0.000843  0.000217  0.000000 -0.000233 -0.000543  0.000777</span></span>
<span id="cb134-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   4  0.000017  0.000637 -0.000473  0.000000  0.000557 -0.000453</span></span>
<span id="cb134-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   5  0.000017 -0.000373 -0.000343  0.000277  0.000000  0.000077</span></span>
<span id="cb134-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   6 -0.000293  0.001307 -0.000783 -0.000023 -0.000113  0.000000</span></span></code></pre></div></li>
<li><div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb135-1" aria-hidden="true" tabindex="-1"></a>good <span class="ot">=</span> (sims<span class="sc">$</span>x <span class="sc">+</span> sims<span class="sc">$</span>y <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb135-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb135-2" aria-hidden="true" tabindex="-1"></a>z_cond <span class="ot">=</span> sims<span class="sc">$</span>z[good]</span>
<span id="cb135-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb135-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">table_sim =</span> <span class="fu">table</span>(z_cond)<span class="sc">/</span><span class="fu">length</span>(z_cond))</span>
<span id="cb135-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="do">## z_cond</span></span>
<span id="cb135-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    1    2    3    4    5    6 </span></span>
<span id="cb135-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.13 0.12 0.25 0.12 0.12 0.25</span></span></code></pre></div></li>
<li><p>We can reuse the code from above (simulation using <code>sample</code>) to list all
possible elementary outcomes with <span class="math inline">\(x+y=6\)</span> and then count the frequencies of different values of the third die in this list (or we could simply do that on a piece of paper):</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb136-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb136-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb136-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb136-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ((i <span class="sc">!=</span> j) <span class="sc">&amp;</span> (j <span class="sc">!=</span> k) <span class="sc">&amp;</span> (i <span class="sc">!=</span> k) <span class="sc">&amp;</span> (i <span class="sc">+</span> j <span class="sc">==</span> <span class="dv">6</span>)) {</span>
<span id="cb136-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-6" aria-hidden="true" tabindex="-1"></a>                df <span class="ot">=</span> <span class="fu">rbind</span>(df, <span class="fu">c</span>(i, j, k))</span>
<span id="cb136-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-7" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb136-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-8" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb136-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb136-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)</span>
<span id="cb136-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-12" aria-hidden="true" tabindex="-1"></a>(<span class="at">table_th =</span> <span class="fu">table</span>(df<span class="sc">$</span>z)<span class="sc">/</span><span class="fu">length</span>(df<span class="sc">$</span>z))</span>
<span id="cb136-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb136-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="do">##    1    2    3    4    5    6 </span></span>
<span id="cb136-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.12 0.12 0.25 0.12 0.12 0.25</span></span></code></pre></div>
<p>The error is given by:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb137-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb137-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">error =</span> table_sim <span class="sc">-</span> table_th)</span>
<span id="cb137-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="do">## z_cond</span></span>
<span id="cb137-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="do">##        1        2        3        4        5        6 </span></span>
<span id="cb137-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.00520 -0.00017 -0.00279 -0.00255 -0.00173  0.00205</span></span></code></pre></div></li>
</ol>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-61" class="exercise"><strong>Problem 2.29  </strong></span>Exactly one percent of the people in a given population have a certain
disease. The accuracy of the diagnostic test for it is such that it
detects the sick as sick with probability <span class="math inline">\(0.95\)</span> and the healthy as
healthy with probability <span class="math inline">\(0.9\)</span>. A person chosen at random from the
population tested positive. What is the probability the he/she is, in
fact, sick. Do the problem both analytically and by Monte Carlo.</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-62" class="solution"><em>Solution</em>. </span></p>
This is a classical example of the unexpected conclusions we sometimes get from the Bayes formula. As usual, we depict the situation using a tree diagram:
<center>
<p><img src="pics/bayes_pic.png" width="50%" style="padding:10px" style="display: block; margin: auto;" /></p>
</center>
<p>The person can test positive (denoted by <span class="math inline">\(tS\)</span> in the plot) in two ways. By actually being sick (<span class="math inline">\(S\)</span>) and then testing positive, or by being healthy and then testing positive. Bayes formula (or simply a look at the picture above) gives us
<span class="math display">\[ {\mathbb{P}}[ S | tS ] = \frac{ 0.01 \times 0.95}{ 0.01\times 0.95 + 0.1\times 0.99 } \approx 0.088.\]</span>
Thus, even when the test is quite accurate, the probability of getting a false positive is very high.</p>
<p>Let us do the same via Monte Carlo. We proceed like this. First we “pick a person” from the population by sampling from <code>c("H", "S")</code> and then “test” this person. After repeating this <code>nsim</code> times, we condition on the positive test, by removing all draws where the test was negative. This leaves us with a population of people who tested positive, and we simply need to see what proportion of those were are actually sick.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-1" aria-hidden="true" tabindex="-1"></a>single_draw <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb138-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-2" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>))</span>
<span id="cb138-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">&quot;H&quot;</span>) {</span>
<span id="cb138-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-4" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;tH&quot;</span>, <span class="st">&quot;tS&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>))</span>
<span id="cb138-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-5" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb138-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-6" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;tH&quot;</span>, <span class="st">&quot;tS&quot;</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>))</span>
<span id="cb138-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb138-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(x, y))</span>
<span id="cb138-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-11" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb138-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">replicate</span>(nsim, <span class="fu">single_draw</span>())))</span>
<span id="cb138-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;status&quot;</span>, <span class="st">&quot;test_result&quot;</span>)</span>
<span id="cb138-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-15" aria-hidden="true" tabindex="-1"></a>cond <span class="ot">=</span> (df<span class="sc">$</span>test_result <span class="sc">==</span> <span class="st">&quot;tS&quot;</span>)</span>
<span id="cb138-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-16" aria-hidden="true" tabindex="-1"></a>df_cond <span class="ot">=</span> df[cond, ]</span>
<span id="cb138-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-17" aria-hidden="true" tabindex="-1"></a>(<span class="at">prob =</span> <span class="fu">mean</span>(df_cond<span class="sc">$</span>status <span class="sc">==</span> <span class="st">&quot;S&quot;</span>))</span>
<span id="cb138-18"><a href="simulation-of-random-variables-and-monte-carlo.html#cb138-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.088</span></span></code></pre></div>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-63" class="exercise"><strong>Problem 2.30  </strong></span>A point is chosen at random, uniformly in the unit cube <span class="math inline">\([0,1]\times [0,1]\times [0,1]\)</span>. Its distance to the origin <span class="math inline">\((0,0,0)\)</span> is measured,
and turns out to be equal to <span class="math inline">\(1.5\)</span>.</p>
<p>Use simulations to estimate the shape of the pdf of the conditional
distribution of the point’s <!--'--> distance to <span class="math inline">\((1,1,1)\)</span>. Compare
it to the unconditional case, i.e., the case where no information
about the distance to <span class="math inline">\((0,0,0)\)</span> is known.</p>
<p>Compute the mean of this (conditional) distribution for a few values
of the parameter <span class="math inline">\(\varepsilon\)</span> you use to deal with conditioning in the
continuous case. Make sure you include values of <span class="math inline">\(\varepsilon\)</span> on both sides
of the spectrum - too big, and too small.</p>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-64" class="solution"><em>Solution</em>. </span>We want to vary the parameter <code>eps</code> later, so let’s write a function first:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-1" aria-hidden="true" tabindex="-1"></a>simulate <span class="ot">=</span> <span class="cf">function</span>(nsim, eps, conditional) {</span>
<span id="cb139-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-2" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb139-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-3" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb139-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-4" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb139-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-5" aria-hidden="true" tabindex="-1"></a>    d1 <span class="ot">=</span> <span class="fu">sqrt</span>((<span class="dv">1</span> <span class="sc">-</span> x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> z)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb139-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (conditional) {</span>
<span id="cb139-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-7" aria-hidden="true" tabindex="-1"></a>        d0 <span class="ot">=</span> <span class="fu">sqrt</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> z<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb139-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-8" aria-hidden="true" tabindex="-1"></a>        cond <span class="ot">=</span> (d0 <span class="sc">&gt;</span> <span class="fl">1.5</span> <span class="sc">-</span> eps) <span class="sc">&amp;</span> (d0 <span class="sc">&lt;</span> <span class="fl">1.5</span> <span class="sc">+</span> eps)</span>
<span id="cb139-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(d1[cond])</span>
<span id="cb139-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-10" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb139-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(d1)</span>
<span id="cb139-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb139-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb139-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Histograms may be used as approximations to the pdf of the (conditional) distribution:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb140-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">1000000</span></span>
<span id="cb140-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb140-2" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb140-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb140-3" aria-hidden="true" tabindex="-1"></a>d1_cond <span class="ot">=</span> <span class="fu">simulate</span>(nsim, eps, <span class="at">conditional =</span> <span class="cn">TRUE</span>)</span>
<span id="cb140-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb140-4" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">=</span> <span class="fu">simulate</span>(nsim, eps, <span class="at">conditional =</span> <span class="cn">FALSE</span>)</span>
<span id="cb140-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb140-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(d1, <span class="at">breaks =</span> <span class="dv">50</span>)</span>
<span id="cb140-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(d1_cond, <span class="at">breaks =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-517-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note that, in addition to clearly different shapes, the supports of the two distributions differ, too. Unconditionally, the distance to <span class="math inline">\((1,1,1)\)</span> can be any number from <span class="math inline">\(0\)</span> to <span class="math inline">\(\sqrt{3} \approx 1.73\)</span>. If it is known that the distance to <span class="math inline">\((0,0,0)\)</span> is <span class="math inline">\(1.5\)</span>, however, the distance to <span class="math inline">\((1,1,1)\)</span> cannot be larger than <span class="math inline">\(1\)</span>.</p>
<p>Finally, let us compare the results we obtain by varying the parameter <span class="math inline">\(\varepsilon\)</span>, first with <code>nsim=100000</code>:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb141-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-2" aria-hidden="true" tabindex="-1"></a>epss <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb141-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-3" aria-hidden="true" tabindex="-1"></a>d1s <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(epss))</span>
<span id="cb141-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (eps <span class="cf">in</span> epss) {</span>
<span id="cb141-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-5" aria-hidden="true" tabindex="-1"></a>    sims <span class="ot">=</span> <span class="fu">simulate</span>(nsim, <span class="at">eps =</span> eps, <span class="at">conditional =</span> <span class="cn">TRUE</span>)</span>
<span id="cb141-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Eps = &quot;</span>, eps, <span class="st">&quot;, Draws = &quot;</span>, <span class="fu">length</span>(sims), <span class="st">&quot; Mean = &quot;</span>, <span class="fu">mean</span>(sims)))</span>
<span id="cb141-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  2 , Draws =  100000  Mean =  0.960342228444094&quot;</span></span>
<span id="cb141-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  1 , Draws =  93544  Mean =  0.929726634933677&quot;</span></span>
<span id="cb141-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.5 , Draws =  47806  Mean =  0.753283074403369&quot;</span></span>
<span id="cb141-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.3 , Draws =  20224  Mean =  0.595529938750379&quot;</span></span>
<span id="cb141-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.2 , Draws =  10658  Mean =  0.496362640888308&quot;</span></span>
<span id="cb141-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.1 , Draws =  3930  Mean =  0.36209037346251&quot;</span></span>
<span id="cb141-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.02 , Draws =  647  Mean =  0.310139851430518&quot;</span></span>
<span id="cb141-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.01 , Draws =  354  Mean =  0.30926108659397&quot;</span></span>
<span id="cb141-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.001 , Draws =  33  Mean =  0.334224126737702&quot;</span></span>
<span id="cb141-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.0001 , Draws =  4  Mean =  0.275311021507976&quot;</span></span></code></pre></div>
<p>The same experiment, but with <code>nsim=1000000</code> yields:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">1000000</span></span>
<span id="cb142-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-2" aria-hidden="true" tabindex="-1"></a>epss <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb142-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-3" aria-hidden="true" tabindex="-1"></a>d1s <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(epss))</span>
<span id="cb142-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (eps <span class="cf">in</span> epss) {</span>
<span id="cb142-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-5" aria-hidden="true" tabindex="-1"></a>    sims <span class="ot">=</span> <span class="fu">simulate</span>(nsim, <span class="at">eps =</span> eps, <span class="at">conditional =</span> <span class="cn">TRUE</span>)</span>
<span id="cb142-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Eps = &quot;</span>, eps, <span class="st">&quot;, Draws = &quot;</span>, <span class="fu">length</span>(sims), <span class="st">&quot; Mean = &quot;</span>, <span class="fu">mean</span>(sims)))</span>
<span id="cb142-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb142-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  2 , Draws =  1000000  Mean =  0.960506260771782&quot;</span></span>
<span id="cb142-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  1 , Draws =  934686  Mean =  0.928432784386909&quot;</span></span>
<span id="cb142-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.5 , Draws =  477123  Mean =  0.753640516540863&quot;</span></span>
<span id="cb142-11"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.3 , Draws =  201634  Mean =  0.596081456550207&quot;</span></span>
<span id="cb142-12"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.2 , Draws =  103279  Mean =  0.494799342061533&quot;</span></span>
<span id="cb142-13"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.1 , Draws =  38529  Mean =  0.361335849359528&quot;</span></span>
<span id="cb142-14"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.02 , Draws =  6944  Mean =  0.3064588479179&quot;</span></span>
<span id="cb142-15"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.01 , Draws =  3371  Mean =  0.30560770769072&quot;</span></span>
<span id="cb142-16"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.001 , Draws =  331  Mean =  0.301734543251831&quot;</span></span>
<span id="cb142-17"><a href="simulation-of-random-variables-and-monte-carlo.html#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;Eps =  0.0001 , Draws =  33  Mean =  0.31500400469211&quot;</span></span></code></pre></div>
</div>
</details>
<div class="exercise">
<p><span id="exr:unlabeled-div-65" class="exercise"><strong>Problem 2.31  </strong></span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>Simulate <span class="math inline">\(10000\)</span> draws from a uniform distribution inside the cube
<span class="math inline">\([-1,1]\times[-1,1] \times [-1,1]\)</span>. Go through your simulations, and discard the
ones that do not lie within the unit ball (the ball centered around <span class="math inline">\((0,0,0)\)</span>,
with radius <span class="math inline">\(1\)</span>.) Now you have a bunch of uniform simulations from the unit ball
(Do not display them).</p></li>
<li><p>Use your simulations to estimate the mean and the standard deviation of <span class="math inline">\(W\)</span>,
where <span class="math inline">\(W\)</span> is the distance from the the origin to a randomly and uniformly
chosen point in the unit ball.</p></li>
<li><p>A point was chosen randomly and uniformly in the unit ball, and it has been observed
that it is closer to the point <span class="math inline">\((1,-1,1)\)</span> than to <span class="math inline">\((1,-1,-1)\)</span>. Estimate (graphically)
the shape of the conditional pdf of its distance to the origin, given this observation.</p></li>
<li><p>(extra credit) Do 3., but with the point chosen uniformly over the <em>surface</em>
of the ball and for the distance to the point <span class="math inline">\((1,1,1)\)</span> and not to the origin
(which is always <span class="math inline">\(1\)</span> in this case). Even more extra points if you do not draw
any additional simulations.</p></li>
</ol>
</div>
<details>
<summary>
Click for Solution
</summary>
<div class="solution">
<p><span id="unlabeled-div-66" class="solution"><em>Solution</em>. </span><br />
</p>
<ol style="list-style-type: decimal">
<li><p>We draw the <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(z\)</span> coordinates independet of each other, and uniformly in <span class="math inline">\([-1,1]\)</span>. Then we discard those simulatione where the sum of the squares is <span class="math inline">\(&gt;1\)</span>:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb143-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-2" aria-hidden="true" tabindex="-1"></a>x_cube <span class="ot">=</span> <span class="fu">runif</span>(nsim, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb143-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-3" aria-hidden="true" tabindex="-1"></a>y_cube <span class="ot">=</span> <span class="fu">runif</span>(nsim, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb143-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-4" aria-hidden="true" tabindex="-1"></a>z_cube <span class="ot">=</span> <span class="fu">runif</span>(nsim, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb143-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-6" aria-hidden="true" tabindex="-1"></a>in_ball <span class="ot">=</span> x_cube<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y_cube<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> z_cube<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span></span>
<span id="cb143-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-8"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> x_cube[in_ball]</span>
<span id="cb143-9"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> y_cube[in_ball]</span>
<span id="cb143-10"><a href="simulation-of-random-variables-and-monte-carlo.html#cb143-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> z_cube[in_ball]</span></code></pre></div></li>
<li><p>By Monte Carlo</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb144-1" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">sqrt</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> z<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb144-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(W)</span>
<span id="cb144-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.75</span></span>
<span id="cb144-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(W)</span>
<span id="cb144-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.19</span></span></code></pre></div>
<p>Note that the mean is not half the radius, i.e. <span class="math inline">\(0.5\)</span>. Why?</p></li>
<li><p>We add two new variables, <span class="math inline">\(d1\)</span> and <span class="math inline">\(d2\)</span> - distances to <span class="math inline">\((1,-1,1)\)</span> and <span class="math inline">\((1,-1,-1)\)</span>, respectively:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb145-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">=</span> <span class="fu">sqrt</span>((x <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (z <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb145-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb145-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">=</span> <span class="fu">sqrt</span>((x <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (z <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb145-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb145-3" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">=</span> d1 <span class="sc">&lt;</span> d2</span>
<span id="cb145-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb145-4" aria-hidden="true" tabindex="-1"></a>W_cond <span class="ot">=</span> W[condition]</span>
<span id="cb145-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(W_cond, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-529-1.png" width="672" style="display: block; margin: auto;" /></p></li>
<li><p>The main difficulty in this part of the problem is getting simulations from the uniform
distributions on the sphere. One possibility is to use the rejection method, and
proceed as in part 1., but keep only those points for which <span class="math display">\[1-\varepsilon &lt;
\sqrt{x^2+y^2+z^2} &lt; 1+\varepsilon\]</span> for some (small) <span class="math inline">\(\varepsilon\)</span>. There is a more
efficient method, though, and it does not involve any new simulations. We simply
take our uniformly distributed points inside the unit ball and project each one onto
the sphere, i.e. replace it by the closest point on the surface. This is easily
achieved since the projection of the point <span class="math inline">\((x,y,z)\)</span> is
<span class="math display">\[\Big(
\frac{x}{\sqrt{x^2+y^2+z^2}},
\frac{y}{\sqrt{x^2+y^2+z^2}},
\frac{y}{\sqrt{x^2+y^2+z^2}},
\Big).\]</span></p>
<p>A moment’s though will convince you that those points indeed cover the sphere uniformly (no direction is preferred!).</p>
<p>Since we already have the distance to the origin stored in the variable <code>W</code>, the code will be
extremely simple:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb146-1" aria-hidden="true" tabindex="-1"></a>x_s <span class="ot">=</span> x<span class="sc">/</span>W</span>
<span id="cb146-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb146-2" aria-hidden="true" tabindex="-1"></a>y_s <span class="ot">=</span> y<span class="sc">/</span>W</span>
<span id="cb146-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb146-3" aria-hidden="true" tabindex="-1"></a>z_s <span class="ot">=</span> z<span class="sc">/</span>W</span></code></pre></div>
<p>The rest now parallels what happened in 2.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="simulation-of-random-variables-and-monte-carlo.html#cb147-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">=</span> <span class="fu">sqrt</span>((x_s <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y_s <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (z_s <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb147-2"><a href="simulation-of-random-variables-and-monte-carlo.html#cb147-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">=</span> <span class="fu">sqrt</span>((x_s <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y_s <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (z_s <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb147-3"><a href="simulation-of-random-variables-and-monte-carlo.html#cb147-3" aria-hidden="true" tabindex="-1"></a>condition <span class="ot">=</span> d1 <span class="sc">&lt;</span> d2</span>
<span id="cb147-4"><a href="simulation-of-random-variables-and-monte-carlo.html#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="simulation-of-random-variables-and-monte-carlo.html#cb147-5" aria-hidden="true" tabindex="-1"></a>W1 <span class="ot">=</span> <span class="fu">sqrt</span>((x <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (z <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb147-6"><a href="simulation-of-random-variables-and-monte-carlo.html#cb147-6" aria-hidden="true" tabindex="-1"></a>W1_cond <span class="ot">=</span> W1[condition]</span>
<span id="cb147-7"><a href="simulation-of-random-variables-and-monte-carlo.html#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(W1_cond, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-531-1.png" width="672" style="display: block; margin: auto;" /></p></li>
</ol>
</div>
</details>
</div>
<div id="endnotes-1" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Endnotes<a href="simulation-of-random-variables-and-monte-carlo.html#endnotes-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>There are infinitely many ways random variables can be
distributed. Indeed, in the discrete <span class="math inline">\({\mathbb N}\)</span>-valued case only, any
sequence of nonnegative numbers <span class="math inline">\((p_n)_n\)</span> such that <span class="math inline">\(\sum_n p_n=1\)</span> defines
<em>a</em> probability distribution. It turns out, however, that a small-ish number of
distributions appear in nature much more often then the rest. These
distributions, like the normal, uniform, exponential, binomial, etc. turn out to
be so important that they each get a name (hence <em>named distributions</em>). <a href="simulation-of-random-variables-and-monte-carlo.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Some books will define the geometric random variables as the number of <em>tosses</em> (and not Ts) before the first H is obtained. In that case, the final H is included into the count. Clearly, this definition and the one we have given differ by <span class="math inline">\(1\)</span>, and this is really not a big deal, but you have to be careful about what is meant when a geometric random variable is mentioned.<a href="simulation-of-random-variables-and-monte-carlo.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>The function <code>sum</code> adds up all the components of the vector.
You would not want such a function to be vectorized. If it were, it would return
exactly the same vector it got as input.<a href="simulation-of-random-variables-and-monte-carlo.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="random-walks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": false,
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/gordanz/M362M/blob/master/source/02-simulation.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"toc_depth": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
